{"version":3,"file":"static/js/363.340138fd.js","mappings":"iSACE,QAEM,MAFN,EAEM,EADJ,QAAgB,O,aCIpB,MAAMA,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,uTCmGA,MAAMC,GAAY,UACZC,GAAU,SAAI,GACdC,GAAe,QAAI,MACnBC,GAAe,QAAI,IACnBC,GAAS,QAAI,MAEbC,GAAO,QAAS,CACpBC,WAAY,OACZC,QAAS,SAILC,EAAmBC,MAAOC,IAC9B,MAAMC,GAAa,QAAaD,EAAKE,IAAK,SAC1C,IAAKD,EAAWE,MAGd,OAFA,KAAUC,MAAMH,EAAWI,OAAO,SAClCf,EAAUgB,MAAMC,aAGlBf,EAAac,MAAQN,EAAKE,IAG1B,IACET,EAAaa,YAAc,QAAaN,EAAKE,IAC/C,CAAE,MAAOE,GACPI,QAAQJ,MAAM,UAAWA,EAC3B,GAIIK,EAAgBT,IACpB,MAAMC,GAAa,QAAaD,EAAM,SACtC,OAAKC,EAAWE,OACd,KAAUC,MAAMH,EAAWI,OAAO,KAG7B,GAIHK,EAAeX,UACnB,GAAKP,EAAac,MAAlB,CAKAf,EAAQe,OAAQ,EAChB,IACE,MAAMK,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQrB,EAAac,OACrCK,EAASE,OAAO,aAAclB,EAAKC,YACnCe,EAASE,OAAO,UAAWlB,EAAKE,SAEhC,MAAMiB,QAAiB,KAASC,aAAaJ,GAC7CjB,EAAOY,MAAQQ,EACf,KAAUE,QAAQ,SACpB,CAAE,MAAOZ,GACPI,QAAQJ,MAAM,UAAWA,EAC3B,CAAE,QACAb,EAAQe,OAAQ,CAClB,CAhBA,MAFE,KAAUW,QAAQ,aAsBhBC,EAAiB,KACrB,GAAIxB,EAAOY,OAAOa,MAAMC,YAAa,CACnC,MAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAO9B,EAAOY,MAAMa,KAAKC,YAC9BC,EAAKI,SAAW/B,EAAOY,MAAMa,KAAKO,aAClCL,EAAKM,OACP,GAIIC,EAAY,KAChBjC,EAAKC,WAAa,OAClBD,EAAKE,QAAU,OACfL,EAAac,MAAQ,KACrBb,EAAaa,MAAQ,GACrBZ,EAAOY,MAAQ,KACfhB,EAAUgB,OAAOC,c,uRA1LjB,QAgGM,MAhGN,EAgGM,EA/FJ,QA8FU,GA9FDsB,MAAM,YAAU,CACZC,QAAM,QACf,IAGM,EAHN,QAGM,MAHN,EAGM,C,aAFJ,QAAiB,YAAX,QAAI,KACV,QAA4B,Q,iBAAnB,IAAS,EAAT,SAAS,oB,2BAItB,IAgEU,EAhEV,QAgEU,GAhEAC,MAAOpC,EAAM,cAAY,S,kBACjC,IAoBe,EApBf,QAoBe,GApBDqC,MAAM,SAASC,SAAA,I,kBAC3B,IAkBY,EAlBZ,QAkBY,G,QAjBN,YAAJC,IAAI,EACH,eAAa,EACbC,MAAO,EACP,YAAWrC,EACX,gBAAeW,EAChB2B,OAAO,6BACPC,KAAA,I,CAMWC,KAAG,QACZ,IAEM,kBAFN,QAEM,OAFDT,MAAM,kBAAiB,oCAE5B,O,iBAPF,IAA4D,EAA5D,QAA4D,GAAnDA,MAAM,mBAAiB,C,iBAAC,IAAiB,EAAjB,SAAiB,2B,mBAClD,QAEM,OAFDA,MAAM,mBAAiB,E,QAAC,iBAChB,QAAa,UAAT,U,wBAWDpC,EAAY,Q,WAAhC,QAIe,G,MAJmBuC,MAAM,Q,kBACtC,IAEM,EAFN,QAEM,MAFN,EAEM,EADJ,QAAsC,OAAhCO,IAAK9C,EAAA,MAAc+C,IAAI,Q,sCAIjC,QAUe,GAVDR,MAAM,QAAM,C,iBACxB,IAKiB,EALjB,QAKiB,G,WALQrC,EAAKC,W,qCAALD,EAAe,e,kBACtC,IAAsC,EAAtC,QAAsC,GAA5BqC,MAAM,QAAM,C,iBAAC,IAAI,kB,QAAJ,QAAI,O,OAC3B,QAA0C,GAAhCA,MAAM,YAAU,C,iBAAC,IAAI,kB,QAAJ,QAAI,O,OAC/B,QAAyC,GAA/BA,MAAM,WAAS,C,iBAAC,IAAI,kB,QAAJ,QAAI,O,OAC9B,QAAyC,GAA/BA,MAAM,WAAS,C,iBAAC,IAAI,kB,QAAJ,QAAI,O,4CAEhC,QAEM,OAFDH,MAAM,YAAW,8BAEtB,M,OAGF,QASe,GATDG,MAAM,QAAM,C,iBACxB,IAIiB,EAJjB,QAIiB,G,WAJQrC,EAAKE,Q,qCAALF,EAAY,Y,kBACnC,IAAwC,EAAxC,QAAwC,GAA9BqC,MAAM,YAAU,C,iBAAC,IAAE,oB,QAAF,MAAE,O,OAC7B,QAAqC,GAA3BA,MAAM,QAAM,C,iBAAC,IAAG,oB,QAAH,OAAG,O,OAC1B,QAAuC,GAA7BA,MAAM,SAAO,C,iBAAC,IAAI,oB,QAAJ,QAAI,O,8CAE9B,QAEM,OAFDH,MAAM,YAAW,4BAEtB,M,OAGF,QAUe,Q,iBATb,IAOY,EAPZ,QAOY,GANVY,KAAK,UACJlD,QAASA,EAAA,MACTmD,UAAWlD,EAAA,MACX,QAAOkB,G,kBAER,IAAiC,E,iBAA9BnB,EAAA,MAAU,SAAW,QAAd,K,gCAEZ,QAA4C,GAAhC,QAAOqC,GAAS,C,iBAAE,IAAE,oB,QAAF,MAAE,O,kCAKzBlC,EAAM,Q,WAAjB,QAkBM,MAlBN,EAkBM,EAjBJ,QAA6B,Q,iBAAjB,IAAI,oB,QAAJ,QAAI,O,OAChB,QAKE,GAJCiD,MAAOjD,EAAO,MAAAkD,IACfH,KAAK,UACJI,UAAU,EACX,gB,mBAEF,QASM,MATN,EASM,EARJ,QAAsD,U,eAAnD,QAAsB,cAAd,SAAK,K,QAAS,KAAC,QAAGnD,EAAO,MAAAyB,KAAK2B,QAAM,MAC/C,QAA4D,U,eAAzD,QAAsB,cAAd,SAAK,K,QAAS,KAAC,QAAGpD,EAAO,MAAAyB,KAAKO,cAAY,MACrD,QAA4D,U,eAAzD,QAAsB,cAAd,SAAK,K,QAAS,KAAC,QAAGhC,EAAO,MAAAyB,KAAK4B,cAAY,MACrD,QAA6D,U,eAA1D,QAAuB,cAAf,UAAM,K,QAAS,KAAC,QAAGrD,EAAO,MAAAyB,KAAK6B,cAAY,MACtD,QAGY,GAHDP,KAAK,UAAW,QAAOvB,G,kBAChC,IAA+B,EAA/B,QAA+B,Q,iBAAtB,IAAY,EAAZ,SAAY,uB,6BAAU,UAEjC,M,kDCvFV,MAAM7B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,uBCHO,SAAS4D,EAAeC,GAC7B,GAAc,IAAVA,EAAa,MAAO,MACxB,MAAMC,EAAI,KACJC,EAAQ,CAAC,IAAK,KAAM,KAAM,MAC1BC,EAAIC,KAAKC,MAAMD,KAAKE,IAAIN,GAASI,KAAKE,IAAIL,IAChD,OAAOM,YAAYP,EAAQI,KAAKI,IAAIP,EAAGE,IAAIM,QAAQ,IAAM,IAAMP,EAAMC,EACvE,CAGO,SAASO,EAAc5D,EAAM6D,GAClC,MAAMC,EAAgB,IAAM9D,EAAK+D,KAAKC,MAAM,KAAKC,MAAMC,cACvD,OAAOL,EAAaM,SAASL,EAC/B,CAGO,SAASM,EAAcpE,EAAMqE,EAAU,WAC5C,OAAOrE,EAAKsE,MAAQD,CACtB,CA4BO,SAASE,EAAavE,GAC3B,OAAO,IAAIwE,QAAQ,CAACC,EAASC,KAC3B,MAAMC,EAAS,IAAIC,WACnBD,EAAOE,OAASC,GAAKL,EAAQK,EAAEC,OAAOrF,QACtCiF,EAAOK,QAAUN,EACjBC,EAAOM,cAAcjF,IAEzB,C,iFAGO,MAAMkF,EAAa,CACxBC,IAAK,CAAC,QACNC,MAAO,CAAC,OAAQ,QAAS,OAAQ,OAAQ,SACzCC,KAAM,CAAC,OAAQ,SACfC,MAAO,CAAC,OAAQ,SAChBC,WAAY,CAAC,OAAQ,UAIhB,SAASC,EAAaxF,EAAMyC,GACjC,MAAMpC,EAAS,GAUf,OARKuD,EAAc5D,EAAMkF,EAAWzC,KAClCpC,EAAOoF,KAAK,cAAcP,EAAWzC,GAAMiD,KAAK,aAG7CtB,EAAcpE,IACjBK,EAAOoF,KAAK,iBAGP,CACLtF,MAAyB,IAAlBE,EAAOsF,OACdtF,SAEJ,C","sources":["webpack://pdf-image-web/./src/views/en/ImageRestore.vue","webpack://pdf-image-web/./src/views/en/ImageRestore.vue?c5c8","webpack://pdf-image-web/./src/components/ImageRestore.vue","webpack://pdf-image-web/./src/components/ImageRestore.vue?874f","webpack://pdf-image-web/./src/utils/file.js"],"sourcesContent":["<template>\r\n  <div class=\"image-restore-page\">\r\n    <ImageRestore />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport ImageRestore from '@/components/ImageRestore.vue'\r\n</script>\r\n\r\n<style scoped>\r\n.image-restore-page {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n","import script from \"./ImageRestore.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImageRestore.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ImageRestore.vue?vue&type=style&index=0&id=1f47122e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f47122e\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"image-restore\">\r\n    <el-card class=\"box-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>旧照修复</span>\r\n          <el-icon><Magic /></el-icon>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-form :model=\"form\" label-width=\"120px\">\r\n        <el-form-item label=\"选择图片文件\" required>\r\n          <el-upload\r\n            ref=\"uploadRef\"\r\n            :auto-upload=\"false\"\r\n            :limit=\"1\"\r\n            :on-change=\"handleFileChange\"\r\n            :before-upload=\"beforeUpload\"\r\n            accept=\".jpg,.jpeg,.png,.bmp,.tiff\"\r\n            drag\r\n          >\r\n            <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n            <div class=\"el-upload__text\">\r\n              将图片文件拖到此处，或<em>点击上传</em>\r\n            </div>\r\n            <template #tip>\r\n              <div class=\"el-upload__tip\">\r\n                支持JPG、PNG、BMP、TIFF格式，且不超过100MB\r\n              </div>\r\n            </template>\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n        <!-- 图片预览 -->\r\n        <el-form-item v-if=\"imagePreview\" label=\"图片预览\">\r\n          <div class=\"image-preview\">\r\n            <img :src=\"imagePreview\" alt=\"预览图片\" />\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"修复类型\">\r\n          <el-radio-group v-model=\"form.repairType\">\r\n            <el-radio label=\"auto\">自动修复</el-radio>\r\n            <el-radio label=\"colorize\">上色修复</el-radio>\r\n            <el-radio label=\"denoise\">降噪修复</el-radio>\r\n            <el-radio label=\"upscale\">超分辨率</el-radio>\r\n          </el-radio-group>\r\n          <div class=\"form-tip\">\r\n            选择修复类型，自动修复会综合多种算法进行智能修复\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"修复质量\">\r\n          <el-radio-group v-model=\"form.quality\">\r\n            <el-radio label=\"standard\">标准</el-radio>\r\n            <el-radio label=\"high\">高质量</el-radio>\r\n            <el-radio label=\"ultra\">超高质量</el-radio>\r\n          </el-radio-group>\r\n          <div class=\"form-tip\">\r\n            选择修复质量，质量越高效果越好但处理时间越长\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n            type=\"primary\"\r\n            :loading=\"loading\"\r\n            :disabled=\"!selectedFile\"\r\n            @click=\"handleSubmit\"\r\n          >\r\n            {{ loading ? '修复中...' : '开始修复' }}\r\n          </el-button>\r\n          <el-button @click=\"resetForm\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 结果显示 -->\r\n      <div v-if=\"result\" class=\"result-section\">\r\n        <el-divider>修复结果</el-divider>\r\n        <el-alert\r\n          :title=\"result.msg\"\r\n          type=\"success\"\r\n          :closable=\"false\"\r\n          show-icon\r\n        />\r\n        <div class=\"result-info\">\r\n          <p><strong>任务ID:</strong> {{ result.data.taskId }}</p>\r\n          <p><strong>修复文件:</strong> {{ result.data.restoredFile }}</p>\r\n          <p><strong>原始尺寸:</strong> {{ result.data.originalSize }}</p>\r\n          <p><strong>修复后尺寸:</strong> {{ result.data.restoredSize }}</p>\r\n          <el-button type=\"success\" @click=\"downloadResult\">\r\n            <el-icon><Download /></el-icon>\r\n            下载结果\r\n          </el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Magic, UploadFilled, Download } from '@element-plus/icons-vue'\r\nimport { imageApi } from '@/api'\r\nimport { validateFile, previewImage } from '@/utils/file'\r\n\r\nconst uploadRef = ref()\r\nconst loading = ref(false)\r\nconst selectedFile = ref(null)\r\nconst imagePreview = ref('')\r\nconst result = ref(null)\r\n\r\nconst form = reactive({\r\n  repairType: 'auto',\r\n  quality: 'high'\r\n})\r\n\r\n// 文件选择处理\r\nconst handleFileChange = async (file) => {\r\n  const validation = validateFile(file.raw, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    uploadRef.value.clearFiles()\r\n    return\r\n  }\r\n  selectedFile.value = file.raw\r\n  \r\n  // 生成图片预览\r\n  try {\r\n    imagePreview.value = await previewImage(file.raw)\r\n  } catch (error) {\r\n    console.error('图片预览失败:', error)\r\n  }\r\n}\r\n\r\n// 上传前验证\r\nconst beforeUpload = (file) => {\r\n  const validation = validateFile(file, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    return false\r\n  }\r\n  return false // 阻止自动上传\r\n}\r\n\r\n// 提交处理\r\nconst handleSubmit = async () => {\r\n  if (!selectedFile.value) {\r\n    ElMessage.warning('请先选择图片文件')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  try {\r\n    const formData = new FormData()\r\n    formData.append('file', selectedFile.value)\r\n    formData.append('repairType', form.repairType)\r\n    formData.append('quality', form.quality)\r\n\r\n    const response = await imageApi.restoreImage(formData)\r\n    result.value = response\r\n    ElMessage.success('旧照修复成功')\r\n  } catch (error) {\r\n    console.error('旧照修复失败:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 下载结果\r\nconst downloadResult = () => {\r\n  if (result.value?.data?.downloadUrl) {\r\n    const link = document.createElement('a')\r\n    link.href = result.value.data.downloadUrl\r\n    link.download = result.value.data.restoredFile\r\n    link.click()\r\n  }\r\n}\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  form.repairType = 'auto'\r\n  form.quality = 'high'\r\n  selectedFile.value = null\r\n  imagePreview.value = ''\r\n  result.value = null\r\n  uploadRef.value?.clearFiles()\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.image-restore {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n}\r\n\r\n.form-tip {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  margin-top: 5px;\r\n}\r\n\r\n.image-preview {\r\n  max-width: 300px;\r\n  max-height: 300px;\r\n  border: 1px solid #dcdfe6;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n\r\n.image-preview img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.result-section {\r\n  margin-top: 20px;\r\n}\r\n\r\n.result-info {\r\n  margin-top: 15px;\r\n  padding: 15px;\r\n  background-color: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n\r\n.result-info p {\r\n  margin: 8px 0;\r\n}\r\n</style>\r\n","import script from \"./ImageRestore.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImageRestore.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ImageRestore.vue?vue&type=style&index=0&id=2ec46122&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2ec46122\"]])\n\nexport default __exports__","/**\r\n * 文件处理工具类\r\n */\r\n\r\n// 文件大小格式化\r\nexport function formatFileSize(bytes) {\r\n  if (bytes === 0) return '0 B'\r\n  const k = 1024\r\n  const sizes = ['B', 'KB', 'MB', 'GB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\r\n}\r\n\r\n// 检查文件类型\r\nexport function checkFileType(file, allowedTypes) {\r\n  const fileExtension = '.' + file.name.split('.').pop().toLowerCase()\r\n  return allowedTypes.includes(fileExtension)\r\n}\r\n\r\n// 检查文件大小\r\nexport function checkFileSize(file, maxSize = 100 * 1024 * 1024) { // 默认100MB\r\n  return file.size <= maxSize\r\n}\r\n\r\n// 获取文件扩展名\r\nexport function getFileExtension(filename) {\r\n  return filename.split('.').pop().toLowerCase()\r\n}\r\n\r\n// 生成唯一文件名\r\nexport function generateUniqueFileName(originalName) {\r\n  const timestamp = Date.now()\r\n  const random = Math.random().toString(36).substring(2, 8)\r\n  const extension = getFileExtension(originalName)\r\n  return `${timestamp}_${random}.${extension}`\r\n}\r\n\r\n// 下载文件\r\nexport function downloadFile(blob, filename) {\r\n  const url = window.URL.createObjectURL(blob)\r\n  const link = document.createElement('a')\r\n  link.href = url\r\n  link.download = filename\r\n  document.body.appendChild(link)\r\n  link.click()\r\n  document.body.removeChild(link)\r\n  window.URL.revokeObjectURL(url)\r\n}\r\n\r\n// 预览图片\r\nexport function previewImage(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n    reader.onload = e => resolve(e.target.result)\r\n    reader.onerror = reject\r\n    reader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\n// 支持的文件类型\r\nexport const FILE_TYPES = {\r\n  PDF: ['.pdf'],\r\n  IMAGE: ['.jpg', '.jpeg', '.png', '.bmp', '.tiff'],\r\n  WORD: ['.doc', '.docx'],\r\n  EXCEL: ['.xls', '.xlsx'],\r\n  POWERPOINT: ['.ppt', '.pptx']\r\n}\r\n\r\n// 文件类型验证\r\nexport function validateFile(file, type) {\r\n  const errors = []\r\n  \r\n  if (!checkFileType(file, FILE_TYPES[type])) {\r\n    errors.push(`文件类型不支持，请上传${FILE_TYPES[type].join('、')}格式的文件`)\r\n  }\r\n  \r\n  if (!checkFileSize(file)) {\r\n    errors.push('文件大小不能超过100MB')\r\n  }\r\n  \r\n  return {\r\n    valid: errors.length === 0,\r\n    errors\r\n  }\r\n}\r\n"],"names":["__exports__","uploadRef","loading","selectedFile","imagePreview","result","form","repairType","quality","handleFileChange","async","file","validation","raw","valid","error","errors","value","clearFiles","console","beforeUpload","handleSubmit","formData","FormData","append","response","restoreImage","success","warning","downloadResult","data","downloadUrl","link","document","createElement","href","download","restoredFile","click","resetForm","class","header","model","label","required","ref","limit","accept","drag","tip","src","alt","type","disabled","title","msg","closable","taskId","originalSize","restoredSize","formatFileSize","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","checkFileType","allowedTypes","fileExtension","name","split","pop","toLowerCase","includes","checkFileSize","maxSize","size","previewImage","Promise","resolve","reject","reader","FileReader","onload","e","target","onerror","readAsDataURL","FILE_TYPES","PDF","IMAGE","WORD","EXCEL","POWERPOINT","validateFile","push","join","length"],"sourceRoot":""}