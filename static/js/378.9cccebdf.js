"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[378],{784:function(e,a,l){l.r(a),l.d(a,{downloadFile:function(){return o},getApiBaseUrl:function(){return n},getDownloadUrl:function(){return t}});const t=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?`${window.APP_CONFIG.API_FULL_URL}${e}`:`http://api.openai2025.com${e}`:"",o=(e,a="")=>{if(!e)return void console.error("Download URL is required");const l=t(e);try{const e=document.createElement("a");e.href=l,e.target="_blank",a&&(e.download=a),document.body.appendChild(e),e.click(),document.body.removeChild(e),console.log("Download started:",l)}catch(o){throw console.error("Download failed:",o),o}},n=()=>window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?window.APP_CONFIG.API_FULL_URL:"http://api.openai2025.com"},1322:function(e,a,l){function t(e){if(0===e)return"0 B";const a=1024,l=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,t)).toFixed(2))+" "+l[t]}function o(e,a){const l="."+e.name.split(".").pop().toLowerCase();return a.includes(l)}function n(e,a=104857600){return e.size<=a}function d(e){return new Promise((a,l)=>{const t=new FileReader;t.onload=e=>a(e.target.result),t.onerror=l,t.readAsDataURL(e)})}l.d(a,{nJ:function(){return u},oz:function(){return d},v7:function(){return t}});const r={PDF:[".pdf"],IMAGE:[".jpg",".jpeg",".png",".bmp",".tiff"],WORD:[".doc",".docx"],EXCEL:[".xls",".xlsx"],POWERPOINT:[".ppt",".pptx"]};function u(e,a){const l=[];return o(e,r[a])||l.push(`文件类型不支持，请上传${r[a].join("、")}格式的文件`),n(e)||l.push("文件大小不能超过100MB"),{valid:0===l.length,errors:l}}},5378:function(e,a,l){l.r(a),l.d(a,{default:function(){return k}});var t=l(641),o=l(953),n=l(33),d=l(163),r=l(8548),u=l(7196),p=l(1322);const i={class:"pdf-convert"},c={class:"card-header"},g={key:0,class:"result-section"},s={class:"result-info"},m={key:0},b={key:1};var F={__name:"PdfConvert",setup(e){const a=(0,o.KR)(),F=(0,o.KR)(!1),f=(0,o.KR)(null),v=(0,o.KR)(null),k=(0,o.Kh)({convertType:"word",outputFormat:"docx",preserveFormatting:!0,extractTables:!1,onePagePerSlide:!0,imageFormat:"png",dpi:300,pageRange:"",encoding:"utf-8",splitByPage:!0,embedImages:!0,headingDetection:"auto",includeImages:!0}),_=()=>{"word"===k.convertType?k.outputFormat="docx":"excel"===k.convertType?k.outputFormat="xlsx":"ppt"===k.convertType?k.outputFormat="pptx":"image"===k.convertType?(k.imageFormat="png",k.dpi=300,k.pageRange=""):"txt"===k.convertType?(k.encoding="utf-8",k.pageRange=""):"html"===k.convertType?(k.splitByPage=!0,k.embedImages=!0,k.pageRange=""):"markdown"===k.convertType&&(k.headingDetection="auto",k.includeImages=!0,k.pageRange="")},P=e=>{const l=(0,p.nJ)(e.raw,"PDF");if(!l.valid)return d.nk.error(l.errors[0]),void a.value.clearFiles();f.value=e.raw},w=e=>{const a=(0,p.nJ)(e,"PDF");return a.valid||d.nk.error(a.errors[0]),!1},y=async()=>{if(f.value){F.value=!0;try{const e=new FormData;let a;switch(e.append("file",f.value),k.convertType){case"word":e.append("outputFormat",k.outputFormat),e.append("preserveFormatting",k.preserveFormatting.toString()),a=await u.DC.convertToWord(e);break;case"excel":e.append("outputFormat",k.outputFormat),e.append("extractTables",k.extractTables.toString()),a=await u.DC.convertToExcel(e);break;case"ppt":e.append("outputFormat",k.outputFormat),e.append("onePagePerSlide",k.onePagePerSlide.toString()),a=await u.DC.convertToPpt(e);break;case"image":e.append("imageFormat",k.imageFormat),e.append("dpi",k.dpi.toString()),e.append("pageRange",k.pageRange),a=await u.DC.convertToImages(e);break;case"txt":e.append("encoding",k.encoding),e.append("pageRange",k.pageRange),a=await u.DC.convertToTxt(e);break;case"html":e.append("splitByPage",k.splitByPage.toString()),e.append("embedImages",k.embedImages.toString()),e.append("pageRange",k.pageRange),a=await u.DC.convertToHtml(e);break;case"markdown":e.append("includeImages",k.includeImages.toString()),e.append("headingDetection",k.headingDetection),e.append("pageRange",k.pageRange),a=await u.DC.convertToMarkdown(e);break}v.value=a,d.nk.success("PDF conversion successful")}catch(e){console.error("PDF conversion failed:",e)}finally{F.value=!1}}else d.nk.warning("Please select a PDF file first")},h=async()=>{if(v.value?.data?.downloadUrl)try{const{downloadFile:e}=l(784),a="image"===k.convertType?"converted_images.zip":v.value.data.convertedFile;e(v.value.data.downloadUrl,a),d.nk.success("Download started")}catch(e){console.error("Download failed:",e),d.nk.error("Download failed, please try again")}else d.nk.warning("No file available for download")},T=()=>{k.convertType="word",k.outputFormat="docx",k.preserveFormatting=!0,k.extractTables=!1,k.onePagePerSlide=!0,k.imageFormat="png",k.dpi=300,k.pageRange="",f.value=null,v.value=null,a.value?.clearFiles()};return(e,l)=>{const d=(0,t.g2)("el-icon"),u=(0,t.g2)("el-upload"),p=(0,t.g2)("el-form-item"),V=(0,t.g2)("el-radio"),R=(0,t.g2)("el-radio-group"),C=(0,t.g2)("el-switch"),D=(0,t.g2)("el-input-number"),x=(0,t.g2)("el-input"),I=(0,t.g2)("el-option"),U=(0,t.g2)("el-select"),L=(0,t.g2)("el-button"),W=(0,t.g2)("el-form"),S=(0,t.g2)("el-divider"),E=(0,t.g2)("el-alert"),O=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(O,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",c,[l[18]||(l[18]=(0,t.Lk)("span",null,"PDF Format Conversion",-1)),(0,t.bF)(d,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.Refresh))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(W,{model:k,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{label:"Select PDF File",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(u,{ref_key:"uploadRef",ref:a,"auto-upload":!1,limit:1,"on-change":P,"before-upload":w,accept:".pdf",drag:""},{tip:(0,t.k6)(()=>[...l[19]||(l[19]=[(0,t.Lk)("div",{class:"el-upload__tip"}," Only PDF files allowed, max 100MB ",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(d,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.UploadFilled))]),_:1}),l[20]||(l[20]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" Drag PDF file here, or "),(0,t.Lk)("em",null,"click to upload")],-1))]),_:1},512)]),_:1}),(0,t.bF)(p,{label:"Convert Type",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:k.convertType,"onUpdate:modelValue":l[0]||(l[0]=e=>k.convertType=e),onChange:_},{default:(0,t.k6)(()=>[(0,t.bF)(V,{label:"word"},{default:(0,t.k6)(()=>[...l[21]||(l[21]=[(0,t.eW)("To Word",-1)])]),_:1}),(0,t.bF)(V,{label:"excel"},{default:(0,t.k6)(()=>[...l[22]||(l[22]=[(0,t.eW)("To Excel",-1)])]),_:1}),(0,t.bF)(V,{label:"ppt"},{default:(0,t.k6)(()=>[...l[23]||(l[23]=[(0,t.eW)("To PPT",-1)])]),_:1}),(0,t.bF)(V,{label:"image"},{default:(0,t.k6)(()=>[...l[24]||(l[24]=[(0,t.eW)("To Images",-1)])]),_:1}),(0,t.bF)(V,{label:"txt"},{default:(0,t.k6)(()=>[...l[25]||(l[25]=[(0,t.eW)("To TXT",-1)])]),_:1}),(0,t.bF)(V,{label:"html"},{default:(0,t.k6)(()=>[...l[26]||(l[26]=[(0,t.eW)("To HTML",-1)])]),_:1}),(0,t.bF)(V,{label:"markdown"},{default:(0,t.k6)(()=>[...l[27]||(l[27]=[(0,t.eW)("To Markdown",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"word"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(p,{label:"Output Format"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:k.outputFormat,"onUpdate:modelValue":l[1]||(l[1]=e=>k.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(V,{label:"docx"},{default:(0,t.k6)(()=>[...l[28]||(l[28]=[(0,t.eW)("DOCX",-1)])]),_:1}),(0,t.bF)(V,{label:"doc"},{default:(0,t.k6)(()=>[...l[29]||(l[29]=[(0,t.eW)("DOC",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Preserve Formatting"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.preserveFormatting,"onUpdate:modelValue":l[2]||(l[2]=e=>k.preserveFormatting=e)},null,8,["modelValue"]),l[30]||(l[30]=(0,t.Lk)("div",{class:"form-tip"},"Whether to preserve original PDF formatting",-1))]),_:1})],64)):(0,t.Q3)("",!0),"excel"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(p,{label:"Output Format"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:k.outputFormat,"onUpdate:modelValue":l[3]||(l[3]=e=>k.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(V,{label:"xlsx"},{default:(0,t.k6)(()=>[...l[31]||(l[31]=[(0,t.eW)("XLSX",-1)])]),_:1}),(0,t.bF)(V,{label:"xls"},{default:(0,t.k6)(()=>[...l[32]||(l[32]=[(0,t.eW)("XLS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Extract Tables Only"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.extractTables,"onUpdate:modelValue":l[4]||(l[4]=e=>k.extractTables=e)},null,8,["modelValue"]),l[33]||(l[33]=(0,t.Lk)("div",{class:"form-tip"},"Whether to extract only table content from PDF",-1))]),_:1})],64)):(0,t.Q3)("",!0),"ppt"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[(0,t.bF)(p,{label:"Output Format"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:k.outputFormat,"onUpdate:modelValue":l[5]||(l[5]=e=>k.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(V,{label:"pptx"},{default:(0,t.k6)(()=>[...l[34]||(l[34]=[(0,t.eW)("PPTX",-1)])]),_:1}),(0,t.bF)(V,{label:"ppt"},{default:(0,t.k6)(()=>[...l[35]||(l[35]=[(0,t.eW)("PPT",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"One Page Per Slide"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.onePagePerSlide,"onUpdate:modelValue":l[6]||(l[6]=e=>k.onePagePerSlide=e)},null,8,["modelValue"]),l[36]||(l[36]=(0,t.Lk)("div",{class:"form-tip"},"Whether to convert each PDF page to one slide",-1))]),_:1})],64)):(0,t.Q3)("",!0),"image"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:3},[(0,t.bF)(p,{label:"Image Format"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:k.imageFormat,"onUpdate:modelValue":l[7]||(l[7]=e=>k.imageFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(V,{label:"png"},{default:(0,t.k6)(()=>[...l[37]||(l[37]=[(0,t.eW)("PNG",-1)])]),_:1}),(0,t.bF)(V,{label:"jpg"},{default:(0,t.k6)(()=>[...l[38]||(l[38]=[(0,t.eW)("JPG",-1)])]),_:1}),(0,t.bF)(V,{label:"jpeg"},{default:(0,t.k6)(()=>[...l[39]||(l[39]=[(0,t.eW)("JPEG",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Resolution (DPI)"},{default:(0,t.k6)(()=>[(0,t.bF)(D,{modelValue:k.dpi,"onUpdate:modelValue":l[8]||(l[8]=e=>k.dpi=e),min:72,max:600,step:72},null,8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Page Range"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:k.pageRange,"onUpdate:modelValue":l[9]||(l[9]=e=>k.pageRange=e),placeholder:"e.g: 1-5 (leave empty to convert all)",clearable:""},null,8,["modelValue"]),l[40]||(l[40]=(0,t.Lk)("div",{class:"form-tip"},"Specify page range to convert, leave empty to convert all pages",-1))]),_:1})],64)):(0,t.Q3)("",!0),"txt"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:4},[(0,t.bF)(p,{label:"Text Encoding"},{default:(0,t.k6)(()=>[(0,t.bF)(U,{modelValue:k.encoding,"onUpdate:modelValue":l[10]||(l[10]=e=>k.encoding=e),placeholder:"Select encoding"},{default:(0,t.k6)(()=>[(0,t.bF)(I,{label:"UTF-8",value:"utf-8"}),(0,t.bF)(I,{label:"GBK",value:"gbk"}),(0,t.bF)(I,{label:"GB2312",value:"gb2312"}),(0,t.bF)(I,{label:"ISO-8859-1",value:"iso-8859-1"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Page Range"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:k.pageRange,"onUpdate:modelValue":l[11]||(l[11]=e=>k.pageRange=e),placeholder:"e.g: 1-5 (leave empty to convert all)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),"html"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:5},[(0,t.bF)(p,{label:"Split by Page"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.splitByPage,"onUpdate:modelValue":l[12]||(l[12]=e=>k.splitByPage=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Embed Images"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.embedImages,"onUpdate:modelValue":l[13]||(l[13]=e=>k.embedImages=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Page Range"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:k.pageRange,"onUpdate:modelValue":l[14]||(l[14]=e=>k.pageRange=e),placeholder:"e.g: 1-5 (leave empty to convert all)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),"markdown"===k.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:6},[(0,t.bF)(p,{label:"Heading Detection"},{default:(0,t.k6)(()=>[(0,t.bF)(U,{modelValue:k.headingDetection,"onUpdate:modelValue":l[15]||(l[15]=e=>k.headingDetection=e)},{default:(0,t.k6)(()=>[(0,t.bF)(I,{label:"Auto",value:"auto"}),(0,t.bF)(I,{label:"Simple",value:"simple"}),(0,t.bF)(I,{label:"None",value:"none"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Include Images"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:k.includeImages,"onUpdate:modelValue":l[16]||(l[16]=e=>k.includeImages=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(p,{label:"Page Range"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:k.pageRange,"onUpdate:modelValue":l[17]||(l[17]=e=>k.pageRange=e),placeholder:"e.g: 1-5 (leave empty to convert all)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),(0,t.bF)(p,null,{default:(0,t.k6)(()=>[(0,t.bF)(L,{type:"primary",loading:F.value,disabled:!f.value,onClick:y},{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(F.value?"Converting...":"Start Convert"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(L,{onClick:T},{default:(0,t.k6)(()=>[...l[41]||(l[41]=[(0,t.eW)("Reset",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),v.value?((0,t.uX)(),(0,t.CE)("div",g,[(0,t.bF)(S,null,{default:(0,t.k6)(()=>[...l[42]||(l[42]=[(0,t.eW)("Conversion Results",-1)])]),_:1}),(0,t.bF)(E,{title:v.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",s,[(0,t.Lk)("p",null,[l[43]||(l[43]=(0,t.Lk)("strong",null,"Task ID:",-1)),(0,t.eW)(" "+(0,n.v_)(v.value.data.taskId),1)]),"image"===k.convertType?((0,t.uX)(),(0,t.CE)("p",m,[l[44]||(l[44]=(0,t.Lk)("strong",null,"Converted Images:",-1)),(0,t.eW)(" "+(0,n.v_)(v.value.data.images?.length||0),1)])):((0,t.uX)(),(0,t.CE)("p",b,[l[45]||(l[45]=(0,t.Lk)("strong",null,"Converted File:",-1)),(0,t.eW)(" "+(0,n.v_)(v.value.data.convertedFile),1)])),(0,t.bF)(L,{type:"success",onClick:h},{default:(0,t.k6)(()=>[(0,t.bF)(d,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.Download))]),_:1}),l[46]||(l[46]=(0,t.eW)(" Download Result ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},f=l(6262);const v=(0,f.A)(F,[["__scopeId","data-v-27b0a47a"]]);var k=v}}]);
//# sourceMappingURL=378.9cccebdf.js.map