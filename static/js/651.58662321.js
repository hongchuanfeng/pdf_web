"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[651],{9680:function(e,l,a){a.r(l),a.d(l,{default:function(){return m}});var t=a(641),n=a(953),u=a(33),o=a(163),d=a(8548),s=a(7196),r=a(784);const c={class:"excel-to-pdf"},i={class:"card-header"},p={key:0,class:"result-section"},k={class:"result-info"};var b={__name:"ExcelToPdf",setup(e){const l=(0,n.KR)(),a=(0,n.KR)(!1),b=(0,n.KR)(null),v=(0,n.KR)(null),f=(0,n.Kh)({sheetRange:"",pageSize:"A4",orientation:"portrait"}),F=e=>{const a=e.raw,t=/\.(xls|xlsx)$/i.test(a.name);if(!t)return o.nk.error("仅支持 .xls/.xlsx 文件"),void l.value.clearFiles();b.value=a},g=e=>{const l=/\.(xls|xlsx)$/i.test(e.name);return l||o.nk.error("仅支持 .xls/.xlsx 文件"),!1},_=async()=>{if(b.value){a.value=!0;try{const e=new FormData;e.append("file",b.value),e.append("sheetRange",f.sheetRange),e.append("pageSize",f.pageSize),e.append("orientation",f.orientation);const l=await s.DC.fromExcel(e);v.value=l,o.nk.success("转换成功")}catch(e){console.error(e)}finally{a.value=!1}}else o.nk.warning("请先选择Excel文件")},x=()=>{if(v.value?.data?.downloadUrl)try{const e=v.value.data.convertedFile||"converted.pdf";(0,r.downloadFile)(v.value.data.downloadUrl,e),o.nk.success("下载已开始")}catch(e){console.error("下载失败:",e),o.nk.error("下载失败，请重试")}else o.nk.warning("没有可下载的文件")},m=()=>{f.sheetRange="",f.pageSize="A4",f.orientation="portrait",b.value=null,v.value=null,l.value?.clearFiles()};return(e,o)=>{const s=(0,t.g2)("el-icon"),r=(0,t.g2)("el-upload"),L=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-input"),w=(0,t.g2)("el-option"),R=(0,t.g2)("el-select"),E=(0,t.g2)("el-button"),D=(0,t.g2)("el-form"),y=(0,t.g2)("el-divider"),C=(0,t.g2)("el-alert"),V=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(V,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",i,[o[3]||(o[3]=(0,t.Lk)("span",null,"Excel 转 PDF",-1)),(0,t.bF)(s,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(d.Document))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(D,{model:f,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"选择Excel文件",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(r,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":F,"before-upload":g,accept:".xls,.xlsx",drag:""},{tip:(0,t.k6)(()=>[...o[4]||(o[4]=[(0,t.Lk)("div",{class:"el-upload__tip"},"只能上传 .xls/.xlsx 文件，且不超过100MB",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(s,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(d.UploadFilled))]),_:1}),o[5]||(o[5]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将Excel文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,t.bF)(L,{label:"工作表范围"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{modelValue:f.sheetRange,"onUpdate:modelValue":o[0]||(o[0]=e=>f.sheetRange=e),placeholder:"如 1-3 或 1,3,5（默认全部）"},null,8,["modelValue"])]),_:1}),(0,t.bF)(L,{label:"纸张大小"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:f.pageSize,"onUpdate:modelValue":o[1]||(o[1]=e=>f.pageSize=e)},{default:(0,t.k6)(()=>[(0,t.bF)(w,{label:"A4",value:"A4"}),(0,t.bF)(w,{label:"Letter",value:"Letter"}),(0,t.bF)(w,{label:"Legal",value:"Legal"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(L,{label:"方向"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:f.orientation,"onUpdate:modelValue":o[2]||(o[2]=e=>f.orientation=e)},{default:(0,t.k6)(()=>[(0,t.bF)(w,{label:"纵向 (portrait)",value:"portrait"}),(0,t.bF)(w,{label:"横向 (landscape)",value:"landscape"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(L,null,{default:(0,t.k6)(()=>[(0,t.bF)(E,{type:"primary",loading:a.value,disabled:!b.value,onClick:_},{default:(0,t.k6)(()=>[(0,t.eW)((0,u.v_)(a.value?"处理中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(E,{onClick:m},{default:(0,t.k6)(()=>[...o[6]||(o[6]=[(0,t.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),v.value?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(y,null,{default:(0,t.k6)(()=>[...o[7]||(o[7]=[(0,t.eW)("处理结果",-1)])]),_:1}),(0,t.bF)(C,{title:v.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",k,[(0,t.Lk)("p",null,[o[8]||(o[8]=(0,t.Lk)("strong",null,"任务ID:",-1)),(0,t.eW)(" "+(0,u.v_)(v.value.data.taskId),1)]),(0,t.Lk)("p",null,[o[9]||(o[9]=(0,t.Lk)("strong",null,"输出文件:",-1)),(0,t.eW)(" "+(0,u.v_)(v.value.data.convertedFile),1)]),(0,t.bF)(E,{type:"success",onClick:x},{default:(0,t.k6)(()=>[(0,t.bF)(s,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(d.Download))]),_:1}),o[10]||(o[10]=(0,t.eW)(" 下载PDF ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},v=a(6262);const f=(0,v.A)(b,[["__scopeId","data-v-c68eb23e"]]);var F=f;const g={class:"excel-to-pdf-page"};var _={__name:"ExcelToPdf",setup(e){return(e,l)=>((0,t.uX)(),(0,t.CE)("div",g,[(0,t.bF)(F),l[0]||(l[0]=(0,t.Lk)("section",{class:"info-block"},[(0,t.Lk)("h2",null,"功能说明"),(0,t.Lk)("p",null,"将Excel表格（.xls/.xlsx）转换为PDF，支持分页、纸张大小与方向设置，尽量保持表格样式。"),(0,t.Lk)("h3",null,"使用案例"),(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,"将财务报表转为PDF提交与归档。"),(0,t.Lk)("li",null,"把数据表格导出为PDF用于审阅与签批。"),(0,t.Lk)("li",null,"统一导出多个Excel工作簿为一个PDF文件。")])],-1))]))}};const x=(0,v.A)(_,[["__scopeId","data-v-fca5954e"]]);var m=x}}]);
//# sourceMappingURL=651.58662321.js.map