{"version":3,"file":"static/js/677.22344970.js","mappings":"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","sources":["webpack://pdf-image-web/./src/utils/download.js","webpack://pdf-image-web/./src/utils/file.js","webpack://pdf-image-web/./src/components/PdfWatermark.vue","webpack://pdf-image-web/./src/components/PdfWatermark.vue?1354","webpack://pdf-image-web/./src/views/PdfWatermark.vue","webpack://pdf-image-web/./src/views/PdfWatermark.vue?74c2"],"sourcesContent":["/**\r\n * 下载工具函数\r\n */\r\n\r\n/**\r\n * 获取完整的下载URL\r\n * @param {string} downloadUrl - 相对下载URL\r\n * @returns {string} - 完整的下载URL\r\n */\r\nexport const getDownloadUrl = (downloadUrl) => {\r\n  if (!downloadUrl) return ''\r\n  \r\n  // 如果已经是完整URL，直接返回\r\n  if (downloadUrl.startsWith('http://') || downloadUrl.startsWith('https://')) {\r\n    return downloadUrl\r\n  }\r\n  \r\n  // 生产环境：使用配置文件中的API地址\r\n  if (process.env.NODE_ENV === 'production') {\r\n    if (window.APP_CONFIG && window.APP_CONFIG.API_FULL_URL) {\r\n      return `${window.APP_CONFIG.API_FULL_URL}${downloadUrl}`\r\n    }\r\n    return `https://api.openai2025.com${downloadUrl}`\r\n  }\r\n  \r\n  // 开发环境：使用相对路径\r\n  return downloadUrl\r\n}\r\n\r\n/**\r\n * 下载文件\r\n * @param {string} downloadUrl - 下载URL\r\n * @param {string} filename - 文件名\r\n */\r\nexport const downloadFile = (downloadUrl, filename = '') => {\r\n  if (!downloadUrl) {\r\n    console.error('Download URL is required')\r\n    return\r\n  }\r\n  \r\n  const fullUrl = getDownloadUrl(downloadUrl)\r\n  \r\n  try {\r\n    const link = document.createElement('a')\r\n    link.href = fullUrl\r\n    link.target = '_blank'\r\n    \r\n    if (filename) {\r\n      link.download = filename\r\n    }\r\n    \r\n    // 添加到DOM并触发点击\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    \r\n    console.log('Download started:', fullUrl)\r\n  } catch (error) {\r\n    console.error('Download failed:', error)\r\n    throw error\r\n  }\r\n}\r\n\r\n/**\r\n * 获取API基础URL（用于调试）\r\n * @returns {string} - API基础URL\r\n */\r\nexport const getApiBaseUrl = () => {\r\n  if (process.env.NODE_ENV === 'production') {\r\n    if (window.APP_CONFIG && window.APP_CONFIG.API_FULL_URL) {\r\n      return window.APP_CONFIG.API_FULL_URL\r\n    }\r\n    return 'https://api.openai2025.com'\r\n  }\r\n  return window.location.origin\r\n}\r\n","/**\r\n * 文件处理工具类\r\n */\r\n\r\n// 文件大小格式化\r\nexport function formatFileSize(bytes) {\r\n  if (bytes === 0) return '0 B'\r\n  const k = 1024\r\n  const sizes = ['B', 'KB', 'MB', 'GB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\r\n}\r\n\r\n// 检查文件类型\r\nexport function checkFileType(file, allowedTypes) {\r\n  const fileExtension = '.' + file.name.split('.').pop().toLowerCase()\r\n  return allowedTypes.includes(fileExtension)\r\n}\r\n\r\n// 检查文件大小\r\nexport function checkFileSize(file, maxSize = 100 * 1024 * 1024) { // 默认100MB\r\n  return file.size <= maxSize\r\n}\r\n\r\n// 获取文件扩展名\r\nexport function getFileExtension(filename) {\r\n  return filename.split('.').pop().toLowerCase()\r\n}\r\n\r\n// 生成唯一文件名\r\nexport function generateUniqueFileName(originalName) {\r\n  const timestamp = Date.now()\r\n  const random = Math.random().toString(36).substring(2, 8)\r\n  const extension = getFileExtension(originalName)\r\n  return `${timestamp}_${random}.${extension}`\r\n}\r\n\r\n// 下载文件\r\nexport function downloadFile(blob, filename) {\r\n  const url = window.URL.createObjectURL(blob)\r\n  const link = document.createElement('a')\r\n  link.href = url\r\n  link.download = filename\r\n  document.body.appendChild(link)\r\n  link.click()\r\n  document.body.removeChild(link)\r\n  window.URL.revokeObjectURL(url)\r\n}\r\n\r\n// 预览图片\r\nexport function previewImage(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n    reader.onload = e => resolve(e.target.result)\r\n    reader.onerror = reject\r\n    reader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\n// 支持的文件类型\r\nexport const FILE_TYPES = {\r\n  PDF: ['.pdf'],\r\n  IMAGE: ['.jpg', '.jpeg', '.png', '.bmp', '.tiff'],\r\n  WORD: ['.doc', '.docx'],\r\n  EXCEL: ['.xls', '.xlsx'],\r\n  POWERPOINT: ['.ppt', '.pptx']\r\n}\r\n\r\n// 文件类型验证\r\nexport function validateFile(file, type) {\r\n  const errors = []\r\n  \r\n  if (!checkFileType(file, FILE_TYPES[type])) {\r\n    errors.push(`文件类型不支持，请上传${FILE_TYPES[type].join('、')}格式的文件`)\r\n  }\r\n  \r\n  if (!checkFileSize(file)) {\r\n    errors.push('文件大小不能超过100MB')\r\n  }\r\n  \r\n  return {\r\n    valid: errors.length === 0,\r\n    errors\r\n  }\r\n}\r\n","<template>\r\n  <div class=\"pdf-watermark\">\r\n    <div class=\"watermark-container\">\r\n      <!-- PDF预览区域 -->\r\n      <div class=\"pdf-preview-section\">\r\n        <el-card class=\"preview-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <span>PDF预览</span>\r\n              <div class=\"preview-controls\">\r\n                <el-button-group>\r\n                  <el-button \r\n                    :disabled=\"currentPage <= 1\" \r\n                    @click=\"prevPage\"\r\n                    size=\"small\"\r\n                  >\r\n                    上一页\r\n                  </el-button>\r\n                  <el-button size=\"small\">\r\n                    {{ currentPage }} / {{ totalPages }}\r\n                  </el-button>\r\n                  <el-button \r\n                    :disabled=\"currentPage >= totalPages\" \r\n                    @click=\"nextPage\"\r\n                    size=\"small\"\r\n                  >\r\n                    下一页\r\n                  </el-button>\r\n                </el-button-group>\r\n                <el-button \r\n                  @click=\"resetZoom\" \r\n                  size=\"small\"\r\n                  style=\"margin-left: 10px;\"\r\n                >\r\n                  重置缩放\r\n                </el-button>\r\n              </div>\r\n            </div>\r\n          </template>\r\n          \r\n          <div class=\"pdf-upload-area\" v-if=\"!pdfDocument\">\r\n            <el-upload\r\n              ref=\"uploadRef\"\r\n              :auto-upload=\"false\"\r\n              :limit=\"1\"\r\n              :on-change=\"handleFileChange\"\r\n              :before-upload=\"beforeUpload\"\r\n              accept=\".pdf\"\r\n              drag\r\n              class=\"pdf-upload\"\r\n            >\r\n              <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n              <div class=\"el-upload__text\">\r\n                将PDF文件拖到此处，或<em>点击上传</em>\r\n              </div>\r\n              <template #tip>\r\n                <div class=\"el-upload__tip\">\r\n                  只能上传PDF文件，且不超过100MB\r\n                </div>\r\n              </template>\r\n            </el-upload>\r\n          </div>\r\n          \r\n          <div v-else class=\"pdf-viewer-container\">\r\n            <!-- PDF预览区域 -->\r\n            <div \r\n              ref=\"pdfViewer\" \r\n              class=\"pdf-viewer\"\r\n              @mousedown=\"handleMouseDown\"\r\n              @mousemove=\"handleMouseMove\"\r\n              @mouseup=\"handleMouseUp\"\r\n              @mouseleave=\"handleMouseUp\"\r\n            >\r\n              <canvas ref=\"pdfCanvas\" class=\"pdf-canvas\" v-if=\"pdfDocument\"></canvas>\r\n              \r\n              <!-- 水印预览层 -->\r\n              <!-- 文字水印预览 -->\r\n              <div \r\n                v-if=\"form.watermarkType === 'text' && form.watermarkText && pdfDocument\"\r\n                class=\"watermark-preview text-watermark\"\r\n                :style=\"watermarkStyle\"\r\n                @mousedown=\"startDrag\"\r\n              >\r\n                {{ form.watermarkText }}\r\n              </div>\r\n              \r\n              <!-- 图片水印预览 -->\r\n              <div \r\n                v-if=\"form.watermarkType === 'image' && watermarkFile && pdfDocument\"\r\n                class=\"watermark-preview image-watermark\"\r\n                :style=\"imageWatermarkStyle\"\r\n                @mousedown=\"startDrag\"\r\n              >\r\n                <img \r\n                  :src=\"watermarkImageUrl\" \r\n                  :alt=\"'水印图片'\"\r\n                  class=\"watermark-image\"\r\n                />\r\n              </div>\r\n            </div>\r\n            \r\n            <!-- 备用预览提示 -->\r\n            <div v-if=\"!pdfDocument\" class=\"pdf-placeholder\">\r\n              <el-icon size=\"48\"><Document /></el-icon>\r\n              <p>PDF预览功能加载中...</p>\r\n              <p class=\"placeholder-tip\">如果长时间无法加载，请刷新页面重试</p>\r\n              <el-button @click=\"retryLoadPdf\" type=\"primary\" size=\"small\" style=\"margin-top: 10px;\">\r\n                重试加载\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </div>\r\n\r\n      <!-- 水印设置面板 -->\r\n      <div class=\"watermark-settings-section\">\r\n        <el-card class=\"settings-card\">\r\n          <template #header>\r\n            <div class=\"card-header\">\r\n              <span>水印设置</span>\r\n              <el-icon><Edit /></el-icon>\r\n            </div>\r\n          </template>\r\n          \r\n          <el-form :model=\"form\" label-width=\"100px\" size=\"small\">\r\n            <el-form-item label=\"水印类型\" required>\r\n              <el-radio-group v-model=\"form.watermarkType\" @change=\"handleWatermarkTypeChange\">\r\n                <el-radio label=\"text\">文字水印</el-radio>\r\n                <el-radio label=\"image\">图片水印</el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n\r\n            <!-- 文字水印设置 -->\r\n            <template v-if=\"form.watermarkType === 'text'\">\r\n              <el-form-item label=\"水印文字\" required>\r\n                <el-input\r\n                  v-model=\"form.watermarkText\"\r\n                  placeholder=\"请输入水印文字\"\r\n                  clearable\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"文字颜色\">\r\n                <el-color-picker v-model=\"form.textColor\" />\r\n                <span class=\"color-preview\" :style=\"{ backgroundColor: form.textColor }\"></span>\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"字体大小\">\r\n                <el-slider\r\n                  v-model=\"form.fontSize\"\r\n                  :min=\"12\"\r\n                  :max=\"120\"\r\n                  :step=\"2\"\r\n                  show-input\r\n                  :format-tooltip=\"formatFontSize\"\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"文字角度\">\r\n                <el-slider\r\n                  v-model=\"form.rotation\"\r\n                  :min=\"0\"\r\n                  :max=\"360\"\r\n                  :step=\"15\"\r\n                  show-input\r\n                  :format-tooltip=\"formatRotation\"\r\n                />\r\n              </el-form-item>\r\n\r\n              <el-form-item label=\"透明度\">\r\n                <el-slider\r\n                  v-model=\"form.opacity\"\r\n                  :min=\"0.1\"\r\n                  :max=\"1\"\r\n                  :step=\"0.1\"\r\n                  show-input\r\n                  :format-tooltip=\"formatOpacity\"\r\n                />\r\n              </el-form-item>\r\n            </template>\r\n\r\n            <!-- 图片水印设置 -->\r\n            <template v-if=\"form.watermarkType === 'image'\">\r\n              <el-form-item label=\"水印图片\" required>\r\n                <el-upload\r\n                  ref=\"watermarkUploadRef\"\r\n                  :auto-upload=\"false\"\r\n                  :limit=\"1\"\r\n                  :on-change=\"handleWatermarkFileChange\"\r\n                  :before-upload=\"beforeWatermarkUpload\"\r\n                  accept=\".jpg,.jpeg,.png,.bmp,.tiff\"\r\n                  drag\r\n                >\r\n                  <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n                  <div class=\"el-upload__text\">\r\n                    将水印图片拖到此处，或<em>点击上传</em>\r\n                  </div>\r\n                  <template #tip>\r\n                    <div class=\"el-upload__tip\">\r\n                      支持JPG、PNG、BMP、TIFF格式的图片\r\n                    </div>\r\n                  </template>\r\n                </el-upload>\r\n              </el-form-item>\r\n            </template>\r\n\r\n            <el-form-item>\r\n              <el-button\r\n                type=\"primary\"\r\n                :loading=\"loading\"\r\n                :disabled=\"!canSubmit\"\r\n                @click=\"handleSubmit\"\r\n                size=\"small\"\r\n              >\r\n                {{ loading ? '处理中...' : '添加水印' }}\r\n              </el-button>\r\n              <el-button @click=\"resetForm\" size=\"small\">重置</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n\r\n          <!-- 结果显示 -->\r\n          <div v-if=\"result\" class=\"result-section\">\r\n            <el-divider>处理结果</el-divider>\r\n            <el-alert\r\n              :title=\"result.msg\"\r\n              type=\"success\"\r\n              :closable=\"false\"\r\n              show-icon\r\n            />\r\n            <div class=\"result-info\">\r\n              <p><strong>任务ID:</strong> {{ result.data.taskId }}</p>\r\n              <p><strong>处理文件:</strong> {{ result.data.watermarkedFile }}</p>\r\n              <el-button type=\"success\" @click=\"downloadResult\" size=\"small\">\r\n                <el-icon><Download /></el-icon>\r\n                下载结果\r\n              </el-button>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted, nextTick } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Edit, UploadFilled, Download } from '@element-plus/icons-vue'\r\nimport { pdfApi } from '@/api'\r\nimport { validateFile, FILE_TYPES } from '@/utils/file'\r\nimport { downloadFile } from '@/utils/download'\r\n// 使用CDN版本的PDF.js以避免兼容性问题\r\nlet pdfjsLib = null\r\n\r\n// 异步加载PDF.js\r\nconst loadPdfJs = async () => {\r\n  if (!pdfjsLib) {\r\n    // 检查是否已经加载了PDF.js\r\n    if (window.pdfjsLib) {\r\n      pdfjsLib = window.pdfjsLib\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js'\r\n      return pdfjsLib\r\n    }\r\n    \r\n    // 动态加载PDF.js CDN版本 - 使用更稳定的2.11.338版本\r\n    const script = document.createElement('script')\r\n    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js'\r\n    script.async = true\r\n    \r\n    return new Promise((resolve, reject) => {\r\n      script.onload = () => {\r\n        pdfjsLib = window.pdfjsLib\r\n        // 设置PDF.js worker\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js'\r\n        resolve(pdfjsLib)\r\n      }\r\n      script.onerror = (error) => {\r\n        console.error('PDF.js加载失败:', error)\r\n        reject(error)\r\n      }\r\n      document.head.appendChild(script)\r\n    })\r\n  }\r\n  return pdfjsLib\r\n}\r\n\r\nconst uploadRef = ref()\r\nconst watermarkUploadRef = ref()\r\nconst pdfCanvas = ref()\r\nconst pdfViewer = ref()\r\nconst loading = ref(false)\r\nconst selectedFile = ref(null)\r\nconst watermarkFile = ref(null)\r\nconst watermarkImageUrl = ref('')\r\nconst result = ref(null)\r\n\r\n// PDF相关状态\r\nconst pdfDocument = ref(null)\r\nconst currentPage = ref(1)\r\nconst totalPages = ref(0)\r\nconst scale = ref(1.0)\r\nconst isDragging = ref(false)\r\nconst dragStart = ref({ x: 0, y: 0 })\r\nconst watermarkPosition = ref({ x: 50, y: 50 }) // 水印位置（百分比）\r\n\r\nconst form = reactive({\r\n  watermarkType: 'text',\r\n  watermarkText: '',\r\n  position: 'center',\r\n  opacity: 0.5,\r\n  textColor: '#FF0000',\r\n  fontSize: 48,\r\n  rotation: 0,\r\n  offsetX: 0,\r\n  offsetY: 0\r\n})\r\n\r\n// 计算是否可以提交\r\nconst canSubmit = computed(() => {\r\n  if (!selectedFile.value) return false\r\n  if (form.watermarkType === 'text' && !form.watermarkText.trim()) return false\r\n  if (form.watermarkType === 'image' && !watermarkFile.value) return false\r\n  return true\r\n})\r\n\r\n// 水印样式计算属性\r\nconst watermarkStyle = computed(() => {\r\n  if (form.watermarkType !== 'text' || !form.watermarkText) return {}\r\n  \r\n  return {\r\n    position: 'absolute',\r\n    left: `${watermarkPosition.value.x}%`,\r\n    top: `${watermarkPosition.value.y}%`,\r\n    transform: `translate(-50%, -50%) rotate(${form.rotation}deg)`,\r\n    color: form.textColor,\r\n    fontSize: `${form.fontSize}px`,\r\n    opacity: form.opacity,\r\n    pointerEvents: 'auto',\r\n    userSelect: 'none',\r\n    whiteSpace: 'nowrap',\r\n    zIndex: 10,\r\n    fontFamily: 'Arial, sans-serif',\r\n    fontWeight: 'bold',\r\n    textShadow: '1px 1px 2px rgba(0,0,0,0.3)',\r\n    cursor: 'move'\r\n  }\r\n})\r\n\r\n// 图片水印样式计算属性\r\nconst imageWatermarkStyle = computed(() => {\r\n  if (form.watermarkType !== 'image' || !watermarkFile.value) return {}\r\n  \r\n  return {\r\n    position: 'absolute',\r\n    left: `${watermarkPosition.value.x}%`,\r\n    top: `${watermarkPosition.value.y}%`,\r\n    transform: `translate(-50%, -50%) rotate(${form.rotation}deg)`,\r\n    opacity: form.opacity,\r\n    pointerEvents: 'auto',\r\n    userSelect: 'none',\r\n    zIndex: 10,\r\n    cursor: 'move',\r\n    maxWidth: '200px',\r\n    maxHeight: '200px'\r\n  }\r\n})\r\n\r\n// 水印类型改变处理\r\nconst handleWatermarkTypeChange = () => {\r\n  form.watermarkText = ''\r\n  watermarkFile.value = null\r\n  watermarkImageUrl.value = ''\r\n  watermarkUploadRef.value?.clearFiles()\r\n}\r\n\r\n// 文件选择处理\r\nconst handleFileChange = async (file) => {\r\n  const validation = validateFile(file.raw, 'PDF')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    uploadRef.value.clearFiles()\r\n    return\r\n  }\r\n  selectedFile.value = file.raw\r\n  await loadPdf(file.raw)\r\n}\r\n\r\n// 加载PDF文件\r\nconst loadPdf = async (file) => {\r\n  try {\r\n    // 确保PDF.js已加载\r\n    const pdfjs = await loadPdfJs()\r\n    \r\n    if (!pdfjs) {\r\n      throw new Error('PDF.js库加载失败')\r\n    }\r\n    \r\n    const arrayBuffer = await file.arrayBuffer()\r\n    const pdf = await pdfjs.getDocument(arrayBuffer).promise\r\n    \r\n    pdfDocument.value = pdf\r\n    totalPages.value = pdf.numPages\r\n    currentPage.value = 1\r\n    \r\n    await renderPage(1)\r\n    ElMessage.success('PDF加载成功')\r\n  } catch (error) {\r\n    console.error('PDF加载失败:', error)\r\n    if (error.message.includes('PDF.js库加载失败')) {\r\n      ElMessage.error('PDF预览功能暂时不可用，请稍后重试')\r\n    } else {\r\n      ElMessage.error('PDF加载失败，请检查文件格式')\r\n    }\r\n  }\r\n}\r\n\r\n// 渲染PDF页面\r\nconst renderPage = async (pageNum) => {\r\n  if (!pdfDocument.value) return\r\n  \r\n  try {\r\n    const page = await pdfDocument.value.getPage(pageNum)\r\n    const canvas = pdfCanvas.value\r\n    const context = canvas.getContext('2d')\r\n    \r\n    // 计算缩放比例\r\n    const viewport = page.getViewport({ scale: scale.value })\r\n    canvas.height = viewport.height\r\n    canvas.width = viewport.width\r\n    \r\n    // 渲染页面\r\n    const renderContext = {\r\n      canvasContext: context,\r\n      viewport: viewport\r\n    }\r\n    \r\n    await page.render(renderContext).promise\r\n  } catch (error) {\r\n    console.error('页面渲染失败:', error)\r\n    \r\n    // 如果是私有成员访问错误，尝试重新加载PDF.js\r\n    if (error.message && error.message.includes('private member')) {\r\n      console.log('检测到PDF.js版本兼容性问题，尝试重新加载...')\r\n      pdfjsLib = null\r\n      window.pdfjsLib = null\r\n      \r\n      // 清除已加载的脚本\r\n      const existingScript = document.querySelector('script[src*=\"pdf.min.js\"]')\r\n      if (existingScript) {\r\n        existingScript.remove()\r\n      }\r\n      \r\n      // 重新加载PDF\r\n      try {\r\n        await loadPdf(selectedFile.value)\r\n      } catch (retryError) {\r\n        console.error('重新加载失败:', retryError)\r\n        ElMessage.error('PDF预览功能暂时不可用，请刷新页面重试')\r\n      }\r\n    } else {\r\n      ElMessage.error('页面渲染失败')\r\n    }\r\n  }\r\n}\r\n\r\n// 上一页\r\nconst prevPage = async () => {\r\n  if (currentPage.value > 1) {\r\n    currentPage.value--\r\n    await renderPage(currentPage.value)\r\n  }\r\n}\r\n\r\n// 下一页\r\nconst nextPage = async () => {\r\n  if (currentPage.value < totalPages.value) {\r\n    currentPage.value++\r\n    await renderPage(currentPage.value)\r\n  }\r\n}\r\n\r\n// 重置缩放\r\nconst resetZoom = async () => {\r\n  scale.value = 1.0\r\n  await renderPage(currentPage.value)\r\n}\r\n\r\n// 重试加载PDF\r\nconst retryLoadPdf = async () => {\r\n  if (selectedFile.value) {\r\n    // 清除当前状态\r\n    pdfDocument.value = null\r\n    pdfjsLib = null\r\n    window.pdfjsLib = null\r\n    \r\n    // 清除已加载的脚本\r\n    const existingScript = document.querySelector('script[src*=\"pdf.min.js\"]')\r\n    if (existingScript) {\r\n      existingScript.remove()\r\n    }\r\n    \r\n    // 重新加载\r\n    await loadPdf(selectedFile.value)\r\n  }\r\n}\r\n\r\n// 拖拽相关方法\r\nconst startDrag = (event) => {\r\n  event.preventDefault()\r\n  isDragging.value = true\r\n  dragStart.value = {\r\n    x: event.clientX,\r\n    y: event.clientY\r\n  }\r\n  document.addEventListener('mousemove', handleDrag)\r\n  document.addEventListener('mouseup', stopDrag)\r\n}\r\n\r\nconst handleDrag = (event) => {\r\n  if (!isDragging.value) return\r\n  \r\n  const rect = pdfViewer.value.getBoundingClientRect()\r\n  const x = ((event.clientX - rect.left) / rect.width) * 100\r\n  const y = ((event.clientY - rect.top) / rect.height) * 100\r\n  \r\n  // 限制在PDF区域内\r\n  watermarkPosition.value = {\r\n    x: Math.max(0, Math.min(100, x)),\r\n    y: Math.max(0, Math.min(100, y))\r\n  }\r\n}\r\n\r\nconst stopDrag = () => {\r\n  isDragging.value = false\r\n  document.removeEventListener('mousemove', handleDrag)\r\n  document.removeEventListener('mouseup', stopDrag)\r\n}\r\n\r\n// 鼠标事件处理（用于PDF画布上的拖拽）\r\nconst handleMouseDown = (event) => {\r\n  if ((form.watermarkType === 'text' && form.watermarkText) || \r\n      (form.watermarkType === 'image' && watermarkFile.value)) {\r\n    startDrag(event)\r\n  }\r\n}\r\n\r\nconst handleMouseMove = (event) => {\r\n  if (isDragging.value) {\r\n    handleDrag(event)\r\n  }\r\n}\r\n\r\nconst handleMouseUp = () => {\r\n  stopDrag()\r\n}\r\n\r\n// 水印文件选择处理\r\nconst handleWatermarkFileChange = (file) => {\r\n  const validation = validateFile(file.raw, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    watermarkUploadRef.value.clearFiles()\r\n    return\r\n  }\r\n  watermarkFile.value = file.raw\r\n  \r\n  // 创建图片预览URL\r\n  const reader = new FileReader()\r\n  reader.onload = (e) => {\r\n    watermarkImageUrl.value = e.target.result\r\n  }\r\n  reader.readAsDataURL(file.raw)\r\n}\r\n\r\n// 上传前验证\r\nconst beforeUpload = (file) => {\r\n  const validation = validateFile(file, 'PDF')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    return false\r\n  }\r\n  return false // 阻止自动上传\r\n}\r\n\r\n// 水印文件上传前验证\r\nconst beforeWatermarkUpload = (file) => {\r\n  const validation = validateFile(file, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    return false\r\n  }\r\n  return false // 阻止自动上传\r\n}\r\n\r\n// 透明度格式化\r\nconst formatOpacity = (value) => {\r\n  return `${Math.round(value * 100)}%`\r\n}\r\n\r\n// 字体大小格式化\r\nconst formatFontSize = (value) => {\r\n  return `${value}px`\r\n}\r\n\r\n// 角度格式化\r\nconst formatRotation = (value) => {\r\n  return `${value}°`\r\n}\r\n\r\n// 提交处理\r\nconst handleSubmit = async () => {\r\n  if (!canSubmit.value) {\r\n    ElMessage.warning('请完善所有必填项')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  try {\r\n    const formData = new FormData()\r\n    formData.append('file', selectedFile.value)\r\n    formData.append('watermarkType', form.watermarkType)\r\n    formData.append('opacity', form.opacity.toString())\r\n\r\n    if (form.watermarkType === 'text') {\r\n      formData.append('watermarkText', form.watermarkText)\r\n      formData.append('textColor', form.textColor)\r\n      formData.append('fontSize', form.fontSize.toString())\r\n      formData.append('rotation', form.rotation.toString())\r\n      \r\n      // 使用拖拽位置而不是预设位置\r\n      formData.append('position', 'custom')\r\n      formData.append('offsetX', watermarkPosition.value.x.toString())\r\n      formData.append('offsetY', watermarkPosition.value.y.toString())\r\n    } else if (form.watermarkType === 'image' && watermarkFile.value) {\r\n      // 图片水印：添加图片文件\r\n      formData.append('watermarkFile', watermarkFile.value)\r\n      formData.append('position', 'custom')\r\n      formData.append('offsetX', watermarkPosition.value.x.toString())\r\n      formData.append('offsetY', watermarkPosition.value.y.toString())\r\n      formData.append('rotation', form.rotation.toString())\r\n    }\r\n\r\n    const response = await pdfApi.addWatermark(formData)\r\n    result.value = response\r\n    ElMessage.success('PDF水印添加成功')\r\n  } catch (error) {\r\n    console.error('PDF水印添加失败:', error)\r\n    ElMessage.error('PDF水印添加失败，请重试')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 下载结果\r\nconst downloadResult = () => {\r\n  if (result.value?.data?.downloadUrl) {\r\n    try {\r\n      const filename = result.value.data.watermarkedFile || 'watermarked.pdf'\r\n      \r\n      // 使用统一的下载工具函数\r\n      downloadFile(result.value.data.downloadUrl, filename)\r\n      \r\n      ElMessage.success('下载已开始')\r\n    } catch (error) {\r\n      console.error('下载失败:', error)\r\n      ElMessage.error('下载失败，请重试')\r\n    }\r\n  } else {\r\n    ElMessage.warning('没有可下载的文件')\r\n  }\r\n}\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  form.watermarkType = 'text'\r\n  form.watermarkText = ''\r\n  form.position = 'center'\r\n  form.opacity = 0.5\r\n  form.textColor = '#FF0000'\r\n  form.fontSize = 48\r\n  form.rotation = 0\r\n  form.offsetX = 0\r\n  form.offsetY = 0\r\n  selectedFile.value = null\r\n  watermarkFile.value = null\r\n  watermarkImageUrl.value = ''\r\n  result.value = null\r\n  pdfDocument.value = null\r\n  currentPage.value = 1\r\n  totalPages.value = 0\r\n  watermarkPosition.value = { x: 50, y: 50 }\r\n  uploadRef.value?.clearFiles()\r\n  watermarkUploadRef.value?.clearFiles()\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.pdf-watermark {\r\n  max-width: 1400px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n}\r\n\r\n.watermark-container {\r\n  display: flex;\r\n  gap: 20px;\r\n  height: calc(100vh - 100px);\r\n}\r\n\r\n.pdf-preview-section {\r\n  flex: 2;\r\n  min-width: 0;\r\n}\r\n\r\n.watermark-settings-section {\r\n  flex: 1;\r\n  min-width: 300px;\r\n}\r\n\r\n.preview-card,\r\n.settings-card {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.preview-card .el-card__body {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0;\r\n}\r\n\r\n.settings-card .el-card__body {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n}\r\n\r\n.preview-controls {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.pdf-upload-area {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40px;\r\n}\r\n\r\n.pdf-upload {\r\n  width: 100%;\r\n}\r\n\r\n.pdf-viewer-container {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n  overflow: auto;\r\n  background-color: #f5f5f5;\r\n  padding: 20px;\r\n}\r\n\r\n.pdf-viewer {\r\n  position: relative;\r\n  display: inline-block;\r\n  margin: 0 auto;\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n  background-color: white;\r\n  cursor: grab;\r\n}\r\n\r\n.pdf-viewer:active {\r\n  cursor: grabbing;\r\n}\r\n\r\n.pdf-canvas {\r\n  display: block;\r\n  max-width: 100%;\r\n  height: auto;\r\n}\r\n\r\n.watermark-preview {\r\n  position: absolute;\r\n  pointer-events: auto;\r\n  cursor: move;\r\n  user-select: none;\r\n  z-index: 10;\r\n  border: 2px dashed #409eff;\r\n  border-radius: 4px;\r\n  background-color: rgba(255, 255, 255, 0.8);\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.watermark-preview:hover {\r\n  border-color: #66b1ff;\r\n  background-color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n/* 文字水印样式 */\r\n.text-watermark {\r\n  padding: 4px 8px;\r\n}\r\n\r\n/* 图片水印样式 */\r\n.image-watermark {\r\n  padding: 2px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.watermark-image {\r\n  max-width: 100%;\r\n  max-height: 100%;\r\n  object-fit: contain;\r\n  border-radius: 2px;\r\n}\r\n\r\n.result-section {\r\n  margin-top: 20px;\r\n}\r\n\r\n.result-info {\r\n  margin-top: 15px;\r\n  padding: 15px;\r\n  background-color: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n\r\n.result-info p {\r\n  margin: 8px 0;\r\n  font-size: 14px;\r\n}\r\n\r\n.color-preview {\r\n  display: inline-block;\r\n  width: 20px;\r\n  height: 20px;\r\n  margin-left: 10px;\r\n  border: 1px solid #dcdfe6;\r\n  border-radius: 4px;\r\n  vertical-align: middle;\r\n}\r\n\r\n/* 响应式设计 */\r\n@media (max-width: 1200px) {\r\n  .watermark-container {\r\n    flex-direction: column;\r\n    height: auto;\r\n  }\r\n  \r\n  .pdf-preview-section,\r\n  .watermark-settings-section {\r\n    flex: none;\r\n  }\r\n  \r\n  .pdf-viewer-container {\r\n    height: 500px;\r\n  }\r\n}\r\n\r\n/* 滚动条样式 */\r\n.pdf-viewer-container::-webkit-scrollbar {\r\n  width: 8px;\r\n  height: 8px;\r\n}\r\n\r\n.pdf-viewer-container::-webkit-scrollbar-track {\r\n  background: #f1f1f1;\r\n  border-radius: 4px;\r\n}\r\n\r\n.pdf-viewer-container::-webkit-scrollbar-thumb {\r\n  background: #c1c1c1;\r\n  border-radius: 4px;\r\n}\r\n\r\n.pdf-viewer-container::-webkit-scrollbar-thumb:hover {\r\n  background: #a8a8a8;\r\n}\r\n\r\n/* PDF占位符样式 */\r\n.pdf-placeholder {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  color: #909399;\r\n  text-align: center;\r\n  padding: 40px;\r\n}\r\n\r\n.pdf-placeholder .el-icon {\r\n  margin-bottom: 16px;\r\n  color: #c0c4cc;\r\n}\r\n\r\n.pdf-placeholder p {\r\n  margin: 8px 0;\r\n  font-size: 14px;\r\n}\r\n\r\n.placeholder-tip {\r\n  font-size: 12px !important;\r\n  color: #c0c4cc !important;\r\n}\r\n</style>\r\n","import script from \"./PdfWatermark.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PdfWatermark.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PdfWatermark.vue?vue&type=style&index=0&id=3f4b735a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3f4b735a\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"pdf-watermark-page\">\r\n    <PdfWatermark />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport PdfWatermark from '@/components/PdfWatermark.vue'\r\n</script>\r\n\r\n<style scoped>\r\n.pdf-watermark-page {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n","import script from \"./PdfWatermark.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PdfWatermark.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PdfWatermark.vue?vue&type=style&index=0&id=0c340363&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0c340363\"]])\n\nexport default __exports__"],"names":["getDownloadUrl","downloadUrl","startsWith","window","APP_CONFIG","API_FULL_URL","downloadFile","filename","console","error","fullUrl","link","document","createElement","href","target","download","body","appendChild","click","removeChild","log","getApiBaseUrl","formatFileSize","bytes","k","sizes","i","Math","floor","parseFloat","pow","toFixed","checkFileType","file","allowedTypes","fileExtension","name","split","pop","toLowerCase","includes","checkFileSize","maxSize","size","previewImage","Promise","resolve","reject","reader","FileReader","onload","e","result","onerror","readAsDataURL","FILE_TYPES","PDF","IMAGE","WORD","EXCEL","POWERPOINT","validateFile","type","errors","push","join","valid","length","pdfjsLib","loadPdfJs","async","GlobalWorkerOptions","workerSrc","script","src","head","uploadRef","watermarkUploadRef","pdfCanvas","pdfViewer","loading","selectedFile","watermarkFile","watermarkImageUrl","pdfDocument","currentPage","totalPages","scale","isDragging","dragStart","x","y","watermarkPosition","form","watermarkType","watermarkText","position","opacity","textColor","fontSize","rotation","offsetX","offsetY","canSubmit","value","trim","watermarkStyle","left","top","transform","color","pointerEvents","userSelect","whiteSpace","zIndex","fontFamily","fontWeight","textShadow","cursor","imageWatermarkStyle","maxWidth","maxHeight","handleWatermarkTypeChange","clearFiles","handleFileChange","validation","raw","loadPdf","pdfjs","Error","arrayBuffer","pdf","getDocument","promise","numPages","renderPage","success","message","pageNum","page","getPage","canvas","context","getContext","viewport","getViewport","height","width","renderContext","canvasContext","render","existingScript","querySelector","remove","retryError","prevPage","nextPage","resetZoom","retryLoadPdf","startDrag","event","preventDefault","clientX","clientY","addEventListener","handleDrag","stopDrag","rect","getBoundingClientRect","max","min","removeEventListener","handleMouseDown","handleMouseMove","handleMouseUp","handleWatermarkFileChange","beforeUpload","beforeWatermarkUpload","formatOpacity","round","formatFontSize","formatRotation","handleSubmit","formData","FormData","append","toString","response","addWatermark","warning","downloadResult","data","watermarkedFile","resetForm","class","header","disabled","style","ref","alt","limit","accept","drag","tip","model","label","required","placeholder","clearable","step","title","msg","closable","taskId","__exports__"],"sourceRoot":""}