"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[786],{784:function(e,l,a){a.r(l),a.d(l,{downloadFile:function(){return t},getApiBaseUrl:function(){return n},getDownloadUrl:function(){return o}});const o=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?`${window.APP_CONFIG.API_FULL_URL}${e}`:`https://api.openai2025.com${e}`:"",t=(e,l="")=>{if(!e)return void console.error("Download URL is required");const a=o(e);try{const e=document.createElement("a");e.href=a,e.target="_blank",l&&(e.download=l),document.body.appendChild(e),e.click(),document.body.removeChild(e),console.log("Download started:",a)}catch(t){throw console.error("Download failed:",t),t}},n=()=>window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?window.APP_CONFIG.API_FULL_URL:"https://api.openai2025.com"},1322:function(e,l,a){function o(e){if(0===e)return"0 B";const l=1024,a=["B","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(l));return parseFloat((e/Math.pow(l,o)).toFixed(2))+" "+a[o]}function t(e,l){const a="."+e.name.split(".").pop().toLowerCase();return l.includes(a)}function n(e,l=104857600){return e.size<=l}function r(e){return new Promise((l,a)=>{const o=new FileReader;o.onload=e=>l(e.target.result),o.onerror=a,o.readAsDataURL(e)})}a.d(l,{nJ:function(){return u},oz:function(){return r},v7:function(){return o}});const d={PDF:[".pdf"],IMAGE:[".jpg",".jpeg",".png",".bmp",".tiff"],WORD:[".doc",".docx"],EXCEL:[".xls",".xlsx"],POWERPOINT:[".ppt",".pptx"]};function u(e,l){const a=[];return t(e,d[l])||a.push(`文件类型不支持，请上传${d[l].join("、")}格式的文件`),n(e)||a.push("文件大小不能超过100MB"),{valid:0===a.length,errors:a}}},1786:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});var o=a(641),t=a(953),n=a(33),r=a(163),d=a(8548),u=a(7196),i=a(784);a(1322);const c={class:"word-to-pdf"},s={class:"card-header"},p={key:0,class:"result-section"},f={class:"result-info"};var b={__name:"WordToPdf",setup(e){const l=(0,t.KR)(),a=(0,t.KR)(!1),b=(0,t.KR)(null),v=(0,t.KR)(null),F=(0,t.Kh)({pageSize:"A4",orientation:"portrait",margins:"36,36,36,36"}),_=e=>{const a=e.raw,o=/\.(doc|docx)$/i.test(a.name);if(!o)return r.nk.error("仅支持 .doc/.docx 文件"),void l.value.clearFiles();b.value=a},g=e=>{const l=/\.(doc|docx)$/i.test(e.name);return l||r.nk.error("仅支持 .doc/.docx 文件"),!1},k=async()=>{if(b.value){a.value=!0;try{const e=new FormData;e.append("file",b.value),e.append("pageSize",F.pageSize),e.append("orientation",F.orientation),e.append("margins",F.margins);const l=await u.DC.fromWord(e);v.value=l,r.nk.success("转换成功")}catch(e){console.error(e)}finally{a.value=!1}}else r.nk.warning("请先选择Word文件")},m=()=>{if(v.value?.data?.downloadUrl)try{const e=v.value.data.convertedFile||"converted.pdf";(0,i.downloadFile)(v.value.data.downloadUrl,e),r.nk.success("下载已开始")}catch(e){console.error("下载失败:",e),r.nk.error("下载失败，请重试")}else r.nk.warning("没有可下载的文件")},w=()=>{F.pageSize="A4",F.orientation="portrait",F.margins="36,36,36,36",b.value=null,v.value=null,l.value?.clearFiles()};return(e,r)=>{const u=(0,o.g2)("el-icon"),i=(0,o.g2)("el-upload"),h=(0,o.g2)("el-form-item"),L=(0,o.g2)("el-option"),P=(0,o.g2)("el-select"),A=(0,o.g2)("el-input"),C=(0,o.g2)("el-button"),U=(0,o.g2)("el-form"),W=(0,o.g2)("el-divider"),R=(0,o.g2)("el-alert"),I=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",c,[(0,o.bF)(I,{class:"box-card"},{header:(0,o.k6)(()=>[(0,o.Lk)("div",s,[r[3]||(r[3]=(0,o.Lk)("span",null,"Word 转 PDF",-1)),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,t.R1)(d.Document))]),_:1})])]),default:(0,o.k6)(()=>[(0,o.bF)(U,{model:F,"label-width":"120px"},{default:(0,o.k6)(()=>[(0,o.bF)(h,{label:"选择Word文件",required:""},{default:(0,o.k6)(()=>[(0,o.bF)(i,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":_,"before-upload":g,accept:".doc,.docx",drag:""},{tip:(0,o.k6)(()=>[...r[4]||(r[4]=[(0,o.Lk)("div",{class:"el-upload__tip"},"只能上传 .doc/.docx 文件，且不超过100MB",-1)])]),default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"el-icon--upload"},{default:(0,o.k6)(()=>[(0,o.bF)((0,t.R1)(d.UploadFilled))]),_:1}),r[5]||(r[5]=(0,o.Lk)("div",{class:"el-upload__text"},[(0,o.eW)(" 将Word文件拖到此处，或"),(0,o.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,o.bF)(h,{label:"纸张大小"},{default:(0,o.k6)(()=>[(0,o.bF)(P,{modelValue:F.pageSize,"onUpdate:modelValue":r[0]||(r[0]=e=>F.pageSize=e)},{default:(0,o.k6)(()=>[(0,o.bF)(L,{label:"A4",value:"A4"}),(0,o.bF)(L,{label:"Letter",value:"Letter"}),(0,o.bF)(L,{label:"Legal",value:"Legal"})]),_:1},8,["modelValue"])]),_:1}),(0,o.bF)(h,{label:"方向"},{default:(0,o.k6)(()=>[(0,o.bF)(P,{modelValue:F.orientation,"onUpdate:modelValue":r[1]||(r[1]=e=>F.orientation=e)},{default:(0,o.k6)(()=>[(0,o.bF)(L,{label:"纵向 (portrait)",value:"portrait"}),(0,o.bF)(L,{label:"横向 (landscape)",value:"landscape"})]),_:1},8,["modelValue"])]),_:1}),(0,o.bF)(h,{label:"页边距"},{default:(0,o.k6)(()=>[(0,o.bF)(A,{modelValue:F.margins,"onUpdate:modelValue":r[2]||(r[2]=e=>F.margins=e),placeholder:"left,top,right,bottom (pt)"},null,8,["modelValue"]),r[6]||(r[6]=(0,o.Lk)("div",{class:"form-tip"},"默认 36,36,36,36（单位：pt）",-1))]),_:1}),(0,o.bF)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(C,{type:"primary",loading:a.value,disabled:!b.value,onClick:k},{default:(0,o.k6)(()=>[(0,o.eW)((0,n.v_)(a.value?"处理中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,o.bF)(C,{onClick:w},{default:(0,o.k6)(()=>[...r[7]||(r[7]=[(0,o.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),v.value?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.bF)(W,null,{default:(0,o.k6)(()=>[...r[8]||(r[8]=[(0,o.eW)("处理结果",-1)])]),_:1}),(0,o.bF)(R,{title:v.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,o.Lk)("div",f,[(0,o.Lk)("p",null,[r[9]||(r[9]=(0,o.Lk)("strong",null,"任务ID:",-1)),(0,o.eW)(" "+(0,n.v_)(v.value.data.taskId),1)]),(0,o.Lk)("p",null,[r[10]||(r[10]=(0,o.Lk)("strong",null,"输出文件:",-1)),(0,o.eW)(" "+(0,n.v_)(v.value.data.convertedFile),1)]),(0,o.bF)(C,{type:"success",onClick:m},{default:(0,o.k6)(()=>[(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,t.R1)(d.Download))]),_:1}),r[11]||(r[11]=(0,o.eW)(" 下载PDF ",-1))]),_:1})])])):(0,o.Q3)("",!0)]),_:1})])}}},v=a(6262);const F=(0,v.A)(b,[["__scopeId","data-v-77d25d4e"]]);var _=F;const g={class:"word-to-pdf-page"};var k={__name:"WordToPdf",setup(e){return(e,l)=>((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(_)]))}};const m=(0,v.A)(k,[["__scopeId","data-v-1ce1bb19"]]);var w=m}}]);
//# sourceMappingURL=786.46026328.js.map