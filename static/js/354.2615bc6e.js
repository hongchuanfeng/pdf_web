"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[354],{1322:function(e,l,a){function t(e){if(0===e)return"0 B";const l=1024,a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(l));return parseFloat((e/Math.pow(l,t)).toFixed(2))+" "+a[t]}function o(e,l){const a="."+e.name.split(".").pop().toLowerCase();return l.includes(a)}function n(e,l=104857600){return e.size<=l}function d(e){return new Promise((l,a)=>{const t=new FileReader;t.onload=e=>l(e.target.result),t.onerror=a,t.readAsDataURL(e)})}a.d(l,{nJ:function(){return u},oz:function(){return d},v7:function(){return t}});const r={PDF:[".pdf"],IMAGE:[".jpg",".jpeg",".png",".bmp",".tiff"],WORD:[".doc",".docx"],EXCEL:[".xls",".xlsx"],POWERPOINT:[".ppt",".pptx"]};function u(e,l){const a=[];return o(e,r[l])||a.push(`文件类型不支持，请上传${r[l].join("、")}格式的文件`),n(e)||a.push("文件大小不能超过100MB"),{valid:0===a.length,errors:a}}},5354:function(e,l,a){a.r(l),a.d(l,{default:function(){return _}});var t=a(641),o=a(953),n=a(33),d=a(163),r=a(8548),u=a(7196);a(1322);const i={class:"word-to-pdf"},c={class:"card-header"},s={key:0,class:"result-section"},p={class:"result-info"};var f={__name:"WordToPdf",setup(e){const l=(0,o.KR)(),a=(0,o.KR)(!1),f=(0,o.KR)(null),b=(0,o.KR)(null),v=(0,o.Kh)({pageSize:"A4",orientation:"portrait",margins:"36,36,36,36"}),k=e=>{const a=e.raw,t=/\.(doc|docx)$/i.test(a.name);if(!t)return d.nk.error("仅支持 .doc/.docx 文件"),void l.value.clearFiles();f.value=a},g=e=>{const l=/\.(doc|docx)$/i.test(e.name);return l||d.nk.error("仅支持 .doc/.docx 文件"),!1},m=async()=>{if(f.value){a.value=!0;try{const e=new FormData;e.append("file",f.value),e.append("pageSize",v.pageSize),e.append("orientation",v.orientation),e.append("margins",v.margins);const l=await u.DC.fromWord(e);b.value=l,d.nk.success("转换成功")}catch(e){console.error(e)}finally{a.value=!1}}else d.nk.warning("请先选择Word文件")},F=()=>{if(b.value?.data?.downloadUrl){const e=document.createElement("a");e.href=b.value.data.downloadUrl,e.download=b.value.data.convertedFile||"converted.pdf",e.click()}},_=()=>{v.pageSize="A4",v.orientation="portrait",v.margins="36,36,36,36",f.value=null,b.value=null,l.value?.clearFiles()};return(e,d)=>{const u=(0,t.g2)("el-icon"),h=(0,t.g2)("el-upload"),w=(0,t.g2)("el-form-item"),L=(0,t.g2)("el-option"),W=(0,t.g2)("el-select"),x=(0,t.g2)("el-input"),R=(0,t.g2)("el-button"),C=(0,t.g2)("el-form"),D=(0,t.g2)("el-divider"),y=(0,t.g2)("el-alert"),V=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(V,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",c,[d[3]||(d[3]=(0,t.Lk)("span",null,"Word 转 PDF",-1)),(0,t.bF)(u,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.Document))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(C,{model:v,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{label:"选择Word文件",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(h,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":k,"before-upload":g,accept:".doc,.docx",drag:""},{tip:(0,t.k6)(()=>[...d[4]||(d[4]=[(0,t.Lk)("div",{class:"el-upload__tip"},"只能上传 .doc/.docx 文件，且不超过100MB",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(u,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.UploadFilled))]),_:1}),d[5]||(d[5]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将Word文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,t.bF)(w,{label:"纸张大小"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{modelValue:v.pageSize,"onUpdate:modelValue":d[0]||(d[0]=e=>v.pageSize=e)},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"A4",value:"A4"}),(0,t.bF)(L,{label:"Letter",value:"Letter"}),(0,t.bF)(L,{label:"Legal",value:"Legal"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(w,{label:"方向"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{modelValue:v.orientation,"onUpdate:modelValue":d[1]||(d[1]=e=>v.orientation=e)},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"纵向 (portrait)",value:"portrait"}),(0,t.bF)(L,{label:"横向 (landscape)",value:"landscape"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(w,{label:"页边距"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.margins,"onUpdate:modelValue":d[2]||(d[2]=e=>v.margins=e),placeholder:"left,top,right,bottom (pt)"},null,8,["modelValue"]),d[6]||(d[6]=(0,t.Lk)("div",{class:"form-tip"},"默认 36,36,36,36（单位：pt）",-1))]),_:1}),(0,t.bF)(w,null,{default:(0,t.k6)(()=>[(0,t.bF)(R,{type:"primary",loading:a.value,disabled:!f.value,onClick:m},{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(a.value?"处理中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(R,{onClick:_},{default:(0,t.k6)(()=>[...d[7]||(d[7]=[(0,t.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),b.value?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(D,null,{default:(0,t.k6)(()=>[...d[8]||(d[8]=[(0,t.eW)("处理结果",-1)])]),_:1}),(0,t.bF)(y,{title:b.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",p,[(0,t.Lk)("p",null,[d[9]||(d[9]=(0,t.Lk)("strong",null,"任务ID:",-1)),(0,t.eW)(" "+(0,n.v_)(b.value.data.taskId),1)]),(0,t.Lk)("p",null,[d[10]||(d[10]=(0,t.Lk)("strong",null,"输出文件:",-1)),(0,t.eW)(" "+(0,n.v_)(b.value.data.convertedFile),1)]),(0,t.bF)(R,{type:"success",onClick:F},{default:(0,t.k6)(()=>[(0,t.bF)(u,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(r.Download))]),_:1}),d[11]||(d[11]=(0,t.eW)(" 下载PDF ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},b=a(6262);const v=(0,b.A)(f,[["__scopeId","data-v-d33fe626"]]);var k=v;const g={class:"word-to-pdf-page"};var m={__name:"WordToPdf",setup(e){return(e,l)=>((0,t.uX)(),(0,t.CE)("div",g,[(0,t.bF)(k)]))}};const F=(0,b.A)(m,[["__scopeId","data-v-1ce1bb19"]]);var _=F}}]);
//# sourceMappingURL=354.2615bc6e.js.map