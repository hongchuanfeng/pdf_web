{"version":3,"file":"static/js/421.34a53c33.js","mappings":"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","sources":["webpack://pdf-image-web/./src/utils/file.js","webpack://pdf-image-web/./src/views/ImageRemoveWatermark.vue","webpack://pdf-image-web/./src/views/ImageRemoveWatermark.vue?e413","webpack://pdf-image-web/./src/components/ImageRemoveWatermark.vue","webpack://pdf-image-web/./src/components/ImageRemoveWatermark.vue?bcf0"],"sourcesContent":["/**\r\n * 文件处理工具类\r\n */\r\n\r\n// 文件大小格式化\r\nexport function formatFileSize(bytes) {\r\n  if (bytes === 0) return '0 B'\r\n  const k = 1024\r\n  const sizes = ['B', 'KB', 'MB', 'GB']\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\r\n}\r\n\r\n// 检查文件类型\r\nexport function checkFileType(file, allowedTypes) {\r\n  const fileExtension = '.' + file.name.split('.').pop().toLowerCase()\r\n  return allowedTypes.includes(fileExtension)\r\n}\r\n\r\n// 检查文件大小\r\nexport function checkFileSize(file, maxSize = 100 * 1024 * 1024) { // 默认100MB\r\n  return file.size <= maxSize\r\n}\r\n\r\n// 获取文件扩展名\r\nexport function getFileExtension(filename) {\r\n  return filename.split('.').pop().toLowerCase()\r\n}\r\n\r\n// 生成唯一文件名\r\nexport function generateUniqueFileName(originalName) {\r\n  const timestamp = Date.now()\r\n  const random = Math.random().toString(36).substring(2, 8)\r\n  const extension = getFileExtension(originalName)\r\n  return `${timestamp}_${random}.${extension}`\r\n}\r\n\r\n// 下载文件\r\nexport function downloadFile(blob, filename) {\r\n  const url = window.URL.createObjectURL(blob)\r\n  const link = document.createElement('a')\r\n  link.href = url\r\n  link.download = filename\r\n  document.body.appendChild(link)\r\n  link.click()\r\n  document.body.removeChild(link)\r\n  window.URL.revokeObjectURL(url)\r\n}\r\n\r\n// 预览图片\r\nexport function previewImage(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader()\r\n    reader.onload = e => resolve(e.target.result)\r\n    reader.onerror = reject\r\n    reader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\n// 支持的文件类型\r\nexport const FILE_TYPES = {\r\n  PDF: ['.pdf'],\r\n  IMAGE: ['.jpg', '.jpeg', '.png', '.bmp', '.tiff'],\r\n  WORD: ['.doc', '.docx'],\r\n  EXCEL: ['.xls', '.xlsx'],\r\n  POWERPOINT: ['.ppt', '.pptx']\r\n}\r\n\r\n// 文件类型验证\r\nexport function validateFile(file, type) {\r\n  const errors = []\r\n  \r\n  if (!checkFileType(file, FILE_TYPES[type])) {\r\n    errors.push(`文件类型不支持，请上传${FILE_TYPES[type].join('、')}格式的文件`)\r\n  }\r\n  \r\n  if (!checkFileSize(file)) {\r\n    errors.push('文件大小不能超过100MB')\r\n  }\r\n  \r\n  return {\r\n    valid: errors.length === 0,\r\n    errors\r\n  }\r\n}\r\n","<template>\r\n  <div class=\"image-watermark-page\">\r\n    <ImageRemoveWatermark />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport ImageRemoveWatermark from '@/components/ImageRemoveWatermark.vue'\r\n</script>\r\n\r\n<style scoped>\r\n.image-watermark-page {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n","import script from \"./ImageRemoveWatermark.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImageRemoveWatermark.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ImageRemoveWatermark.vue?vue&type=style&index=0&id=e62d7862&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e62d7862\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"image-remove-watermark\">\r\n    <el-card class=\"box-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>图片去水印</span>\r\n          <el-icon><Picture /></el-icon>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-form :model=\"form\" label-width=\"120px\">\r\n        <el-form-item label=\"选择图片文件\" required>\r\n          <el-upload\r\n            ref=\"uploadRef\"\r\n            :auto-upload=\"false\"\r\n            :limit=\"1\"\r\n            :on-change=\"handleFileChange\"\r\n            :before-upload=\"beforeUpload\"\r\n            accept=\".jpg,.jpeg,.png,.bmp,.tiff\"\r\n            drag\r\n          >\r\n            <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n            <div class=\"el-upload__text\">\r\n              将图片文件拖到此处，或<em>点击上传</em>\r\n            </div>\r\n            <template #tip>\r\n              <div class=\"el-upload__tip\">\r\n                支持JPG、PNG、BMP、TIFF格式，且不超过100MB\r\n              </div>\r\n            </template>\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n        <!-- 图片预览 -->\r\n        <el-form-item v-if=\"imagePreview\" label=\"图片预览\">\r\n          <div class=\"image-preview\">\r\n            <img :src=\"imagePreview\" alt=\"预览图片\" />\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"水印区域\">\r\n          <el-input\r\n            v-model=\"form.watermarkArea\"\r\n            placeholder=\"格式: x1,y1,x2,y2 (不填则自动检测)\"\r\n            clearable\r\n          />\r\n          <div class=\"form-tip\">\r\n            手动指定水印区域坐标，格式为\"x1,y1,x2,y2\"，不填则自动检测水印位置\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"去水印算法\">\r\n          <el-radio-group v-model=\"form.algorithm\">\r\n            <el-radio label=\"auto\">自动选择</el-radio>\r\n            <el-radio label=\"inpainting\">修复算法</el-radio>\r\n            <el-radio label=\"cloning\">克隆算法</el-radio>\r\n          </el-radio-group>\r\n          <div class=\"form-tip\">\r\n            选择最适合的去水印算法，自动选择会根据图片特征自动选择最佳算法\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n            type=\"primary\"\r\n            :loading=\"loading\"\r\n            :disabled=\"!selectedFile\"\r\n            @click=\"handleSubmit\"\r\n          >\r\n            {{ loading ? '处理中...' : '开始去水印' }}\r\n          </el-button>\r\n          <el-button @click=\"resetForm\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 结果显示 -->\r\n      <div v-if=\"result\" class=\"result-section\">\r\n        <el-divider>处理结果</el-divider>\r\n        <el-alert\r\n          :title=\"result.msg\"\r\n          type=\"success\"\r\n          :closable=\"false\"\r\n          show-icon\r\n        />\r\n        <div class=\"result-info\">\r\n          <p><strong>任务ID:</strong> {{ result.data.taskId }}</p>\r\n          <p><strong>处理文件:</strong> {{ result.data.processedFile }}</p>\r\n          <el-button type=\"success\" @click=\"downloadResult\">\r\n            <el-icon><Download /></el-icon>\r\n            下载结果\r\n          </el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Picture, UploadFilled, Download } from '@element-plus/icons-vue'\r\nimport { imageApi } from '@/api'\r\nimport { validateFile, previewImage } from '@/utils/file'\r\n\r\nconst uploadRef = ref()\r\nconst loading = ref(false)\r\nconst selectedFile = ref(null)\r\nconst imagePreview = ref('')\r\nconst result = ref(null)\r\n\r\nconst form = reactive({\r\n  watermarkArea: '',\r\n  algorithm: 'auto'\r\n})\r\n\r\n// 文件选择处理\r\nconst handleFileChange = async (file) => {\r\n  const validation = validateFile(file.raw, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    uploadRef.value.clearFiles()\r\n    return\r\n  }\r\n  selectedFile.value = file.raw\r\n  \r\n  // 生成图片预览\r\n  try {\r\n    imagePreview.value = await previewImage(file.raw)\r\n  } catch (error) {\r\n    console.error('图片预览失败:', error)\r\n  }\r\n}\r\n\r\n// 上传前验证\r\nconst beforeUpload = (file) => {\r\n  const validation = validateFile(file, 'IMAGE')\r\n  if (!validation.valid) {\r\n    ElMessage.error(validation.errors[0])\r\n    return false\r\n  }\r\n  return false // 阻止自动上传\r\n}\r\n\r\n// 提交处理\r\nconst handleSubmit = async () => {\r\n  if (!selectedFile.value) {\r\n    ElMessage.warning('请先选择图片文件')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  try {\r\n    const formData = new FormData()\r\n    formData.append('file', selectedFile.value)\r\n    formData.append('watermarkArea', form.watermarkArea)\r\n    formData.append('algorithm', form.algorithm)\r\n\r\n    const response = await imageApi.removeWatermark(formData)\r\n    result.value = response\r\n    ElMessage.success('图片去水印成功')\r\n  } catch (error) {\r\n    console.error('图片去水印失败:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 下载结果\r\nconst downloadResult = () => {\r\n  if (result.value?.data?.downloadUrl) {\r\n    const link = document.createElement('a')\r\n    link.href = result.value.data.downloadUrl\r\n    link.download = result.value.data.processedFile\r\n    link.click()\r\n  }\r\n}\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  form.watermarkArea = ''\r\n  form.algorithm = 'auto'\r\n  selectedFile.value = null\r\n  imagePreview.value = ''\r\n  result.value = null\r\n  uploadRef.value?.clearFiles()\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.image-remove-watermark {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n}\r\n\r\n.form-tip {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  margin-top: 5px;\r\n}\r\n\r\n.image-preview {\r\n  max-width: 300px;\r\n  max-height: 300px;\r\n  border: 1px solid #dcdfe6;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n\r\n.image-preview img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.result-section {\r\n  margin-top: 20px;\r\n}\r\n\r\n.result-info {\r\n  margin-top: 15px;\r\n  padding: 15px;\r\n  background-color: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n\r\n.result-info p {\r\n  margin: 8px 0;\r\n}\r\n</style>\r\n","import script from \"./ImageRemoveWatermark.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImageRemoveWatermark.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ImageRemoveWatermark.vue?vue&type=style&index=0&id=24b8407e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-24b8407e\"]])\n\nexport default __exports__"],"names":["formatFileSize","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","checkFileType","file","allowedTypes","fileExtension","name","split","pop","toLowerCase","includes","checkFileSize","maxSize","size","previewImage","Promise","resolve","reject","reader","FileReader","onload","e","target","result","onerror","readAsDataURL","FILE_TYPES","PDF","IMAGE","WORD","EXCEL","POWERPOINT","validateFile","type","errors","push","join","valid","length","__exports__","uploadRef","loading","selectedFile","imagePreview","form","watermarkArea","algorithm","handleFileChange","async","validation","raw","error","value","clearFiles","console","beforeUpload","handleSubmit","formData","FormData","append","response","removeWatermark","success","warning","downloadResult","data","downloadUrl","link","document","createElement","href","download","processedFile","click","resetForm","class","header","model","label","required","ref","limit","accept","drag","tip","src","alt","placeholder","clearable","disabled","title","msg","closable","taskId"],"sourceRoot":""}