"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[777],{784:function(e,l,a){a.r(l),a.d(l,{downloadFile:function(){return o},getApiBaseUrl:function(){return n},getDownloadUrl:function(){return t}});const t=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?`${window.APP_CONFIG.API_FULL_URL}${e}`:`https://api.openai2025.com${e}`:"",o=(e,l="")=>{if(!e)return void console.error("Download URL is required");const a=t(e);try{const e=document.createElement("a");e.href=a,e.target="_blank",l&&(e.download=l),document.body.appendChild(e),e.click(),document.body.removeChild(e),console.log("Download started:",a)}catch(o){throw console.error("Download failed:",o),o}},n=()=>window.APP_CONFIG&&window.APP_CONFIG.API_FULL_URL?window.APP_CONFIG.API_FULL_URL:"https://api.openai2025.com"},4777:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});var t=a(641),o=a(953),n=a(33),d=a(163),u=a(8548),r=a(7196),s=a(784);const i={class:"excel-to-pdf"},c={class:"card-header"},p={key:0,class:"result-section"},b={class:"result-info"};var _={__name:"ExcelToPdf",setup(e){const l=(0,o.KR)(),a=(0,o.KR)(!1),_=(0,o.KR)(null),f=(0,o.KR)(null),v=(0,o.Kh)({sheetRange:"",pageSize:"A4",orientation:"portrait"}),k=e=>{const a=e.raw,t=/\.(xls|xlsx)$/i.test(a.name);if(!t)return d.nk.error("仅支持 .xls/.xlsx 文件"),void l.value.clearFiles();_.value=a},F=e=>{const l=/\.(xls|xlsx)$/i.test(e.name);return l||d.nk.error("仅支持 .xls/.xlsx 文件"),!1},g=async()=>{if(_.value){a.value=!0;try{const e=new FormData;e.append("file",_.value),e.append("sheetRange",v.sheetRange),e.append("pageSize",v.pageSize),e.append("orientation",v.orientation);const l=await r.DC.fromExcel(e);f.value=l,d.nk.success("转换成功")}catch(e){console.error(e)}finally{a.value=!1}}else d.nk.warning("请先选择Excel文件")},m=()=>{if(f.value?.data?.downloadUrl)try{const e=f.value.data.convertedFile||"converted.pdf";(0,s.downloadFile)(f.value.data.downloadUrl,e),d.nk.success("下载已开始")}catch(e){console.error("下载失败:",e),d.nk.error("下载失败，请重试")}else d.nk.warning("没有可下载的文件")},w=()=>{v.sheetRange="",v.pageSize="A4",v.orientation="portrait",_.value=null,f.value=null,l.value?.clearFiles()};return(e,d)=>{const r=(0,t.g2)("el-icon"),s=(0,t.g2)("el-upload"),x=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-input"),L=(0,t.g2)("el-option"),P=(0,t.g2)("el-select"),R=(0,t.g2)("el-button"),A=(0,t.g2)("el-form"),C=(0,t.g2)("el-divider"),U=(0,t.g2)("el-alert"),I=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(I,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",c,[d[3]||(d[3]=(0,t.Lk)("span",null,"Excel 转 PDF",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.Document))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(A,{model:v,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{label:"选择Excel文件",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(s,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":k,"before-upload":F,accept:".xls,.xlsx",drag:""},{tip:(0,t.k6)(()=>[...d[4]||(d[4]=[(0,t.Lk)("div",{class:"el-upload__tip"},"只能上传 .xls/.xlsx 文件，且不超过100MB",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(r,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.UploadFilled))]),_:1}),d[5]||(d[5]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将Excel文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,t.bF)(x,{label:"工作表范围"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{modelValue:v.sheetRange,"onUpdate:modelValue":d[0]||(d[0]=e=>v.sheetRange=e),placeholder:"如 1-3 或 1,3,5（默认全部）"},null,8,["modelValue"])]),_:1}),(0,t.bF)(x,{label:"纸张大小"},{default:(0,t.k6)(()=>[(0,t.bF)(P,{modelValue:v.pageSize,"onUpdate:modelValue":d[1]||(d[1]=e=>v.pageSize=e)},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"A4",value:"A4"}),(0,t.bF)(L,{label:"Letter",value:"Letter"}),(0,t.bF)(L,{label:"Legal",value:"Legal"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(x,{label:"方向"},{default:(0,t.k6)(()=>[(0,t.bF)(P,{modelValue:v.orientation,"onUpdate:modelValue":d[2]||(d[2]=e=>v.orientation=e)},{default:(0,t.k6)(()=>[(0,t.bF)(L,{label:"纵向 (portrait)",value:"portrait"}),(0,t.bF)(L,{label:"横向 (landscape)",value:"landscape"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(x,null,{default:(0,t.k6)(()=>[(0,t.bF)(R,{type:"primary",loading:a.value,disabled:!_.value,onClick:g},{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(a.value?"处理中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(R,{onClick:w},{default:(0,t.k6)(()=>[...d[6]||(d[6]=[(0,t.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),f.value?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.bF)(C,null,{default:(0,t.k6)(()=>[...d[7]||(d[7]=[(0,t.eW)("处理结果",-1)])]),_:1}),(0,t.bF)(U,{title:f.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",b,[(0,t.Lk)("p",null,[d[8]||(d[8]=(0,t.Lk)("strong",null,"任务ID:",-1)),(0,t.eW)(" "+(0,n.v_)(f.value.data.taskId),1)]),(0,t.Lk)("p",null,[d[9]||(d[9]=(0,t.Lk)("strong",null,"输出文件:",-1)),(0,t.eW)(" "+(0,n.v_)(f.value.data.convertedFile),1)]),(0,t.bF)(R,{type:"success",onClick:m},{default:(0,t.k6)(()=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.Download))]),_:1}),d[10]||(d[10]=(0,t.eW)(" 下载PDF ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},f=a(6262);const v=(0,f.A)(_,[["__scopeId","data-v-c68eb23e"]]);var k=v;const F={class:"excel-to-pdf-page"};var g={__name:"ExcelToPdf",setup(e){return(e,l)=>((0,t.uX)(),(0,t.CE)("div",F,[(0,t.bF)(k)]))}};const m=(0,f.A)(g,[["__scopeId","data-v-4b960fa1"]]);var w=m}}]);
//# sourceMappingURL=777.97f6e386.js.map