"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[204],{2204:function(e,l,a){a.r(l),a.d(l,{default:function(){return m}});var t=a(641),d=a(953),o=a(33),n=a(163),u=a(8548),p=a(7196);const i={class:"ppt-to-pdf"},r={class:"card-header"},s={key:0,class:"result-section"},c={class:"result-info"};var b={__name:"PptToPdf",setup(e){const l=(0,d.KR)(),a=(0,d.KR)(!1),b=(0,d.KR)(null),v=(0,d.KR)(null),k=(0,d.Kh)({slides:"",oneSlidePerPage:!0,pageSize:"A4",orientation:"portrait"}),f=e=>{const a=e.raw,t=/\.(ppt|pptx)$/i.test(a.name);if(!t)return n.nk.error("仅支持 .ppt/.pptx 文件"),void l.value.clearFiles();b.value=a},F=e=>{const l=/\.(ppt|pptx)$/i.test(e.name);return l||n.nk.error("仅支持 .ppt/.pptx 文件"),!1},_=async()=>{if(b.value){a.value=!0;try{const e=new FormData;e.append("file",b.value),e.append("slides",k.slides),e.append("oneSlidePerPage",k.oneSlidePerPage),e.append("pageSize",k.pageSize),e.append("orientation",k.orientation);const l=await p.DC.fromPpt(e);v.value=l,n.nk.success("转换成功")}catch(e){console.error(e)}finally{a.value=!1}}else n.nk.warning("请先选择PPT文件")},g=()=>{if(v.value?.data?.downloadUrl){const e=document.createElement("a");e.href=v.value.data.downloadUrl,e.download=v.value.data.convertedFile||"converted.pdf",e.click()}},m=()=>{k.slides="",k.oneSlidePerPage=!0,k.pageSize="A4",k.orientation="portrait",b.value=null,v.value=null,l.value?.clearFiles()};return(e,n)=>{const p=(0,t.g2)("el-icon"),P=(0,t.g2)("el-upload"),w=(0,t.g2)("el-form-item"),L=(0,t.g2)("el-input"),h=(0,t.g2)("el-switch"),S=(0,t.g2)("el-option"),V=(0,t.g2)("el-select"),x=(0,t.g2)("el-button"),y=(0,t.g2)("el-form"),C=(0,t.g2)("el-divider"),R=(0,t.g2)("el-alert"),D=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",i,[(0,t.bF)(D,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",r,[n[4]||(n[4]=(0,t.Lk)("span",null,"PPT 转 PDF",-1)),(0,t.bF)(p,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,d.R1)(u.Document))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(y,{model:k,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{label:"选择PPT文件",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(P,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":f,"before-upload":F,accept:".ppt,.pptx",drag:""},{tip:(0,t.k6)(()=>[...n[5]||(n[5]=[(0,t.Lk)("div",{class:"el-upload__tip"},"只能上传 .ppt/.pptx 文件，且不超过100MB",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(p,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,d.R1)(u.UploadFilled))]),_:1}),n[6]||(n[6]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将PPT文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,t.bF)(w,{label:"幻灯片范围"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{modelValue:k.slides,"onUpdate:modelValue":n[0]||(n[0]=e=>k.slides=e),placeholder:"如 1-10（默认全部）"},null,8,["modelValue"])]),_:1}),(0,t.bF)(w,{label:"一页一幻灯片"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{modelValue:k.oneSlidePerPage,"onUpdate:modelValue":n[1]||(n[1]=e=>k.oneSlidePerPage=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(w,{label:"纸张大小"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:k.pageSize,"onUpdate:modelValue":n[2]||(n[2]=e=>k.pageSize=e)},{default:(0,t.k6)(()=>[(0,t.bF)(S,{label:"A4",value:"A4"}),(0,t.bF)(S,{label:"Letter",value:"Letter"}),(0,t.bF)(S,{label:"Legal",value:"Legal"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(w,{label:"方向"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:k.orientation,"onUpdate:modelValue":n[3]||(n[3]=e=>k.orientation=e)},{default:(0,t.k6)(()=>[(0,t.bF)(S,{label:"纵向 (portrait)",value:"portrait"}),(0,t.bF)(S,{label:"横向 (landscape)",value:"landscape"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(w,null,{default:(0,t.k6)(()=>[(0,t.bF)(x,{type:"primary",loading:a.value,disabled:!b.value,onClick:_},{default:(0,t.k6)(()=>[(0,t.eW)((0,o.v_)(a.value?"处理中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(x,{onClick:m},{default:(0,t.k6)(()=>[...n[7]||(n[7]=[(0,t.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),v.value?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(C,null,{default:(0,t.k6)(()=>[...n[8]||(n[8]=[(0,t.eW)("处理结果",-1)])]),_:1}),(0,t.bF)(R,{title:v.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",c,[(0,t.Lk)("p",null,[n[9]||(n[9]=(0,t.Lk)("strong",null,"任务ID:",-1)),(0,t.eW)(" "+(0,o.v_)(v.value.data.taskId),1)]),(0,t.Lk)("p",null,[n[10]||(n[10]=(0,t.Lk)("strong",null,"输出文件:",-1)),(0,t.eW)(" "+(0,o.v_)(v.value.data.convertedFile),1)]),(0,t.bF)(x,{type:"success",onClick:g},{default:(0,t.k6)(()=>[(0,t.bF)(p,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,d.R1)(u.Download))]),_:1}),n[11]||(n[11]=(0,t.eW)(" 下载PDF ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},v=a(6262);const k=(0,v.A)(b,[["__scopeId","data-v-7a72688c"]]);var f=k;const F={class:"ppt-to-pdf-page"};var _={__name:"PptToPdf",setup(e){return(e,l)=>((0,t.uX)(),(0,t.CE)("div",F,[(0,t.bF)(f)]))}};const g=(0,v.A)(_,[["__scopeId","data-v-14b0867e"]]);var m=g}}]);
//# sourceMappingURL=204.a07ba396.js.map