"use strict";(self["webpackChunkpdf_image_web"]=self["webpackChunkpdf_image_web"]||[]).push([[539],{1322:function(e,l,a){function t(e){if(0===e)return"0 B";const l=1024,a=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(l));return parseFloat((e/Math.pow(l,t)).toFixed(2))+" "+a[t]}function o(e,l){const a="."+e.name.split(".").pop().toLowerCase();return l.includes(a)}function n(e,l=104857600){return e.size<=l}a.d(l,{nJ:function(){return u},v7:function(){return t}});const d={PDF:[".pdf"],IMAGE:[".jpg",".jpeg",".png",".bmp",".tiff"],WORD:[".doc",".docx"],EXCEL:[".xls",".xlsx"],POWERPOINT:[".ppt",".pptx"]};function u(e,l){const a=[];return o(e,d[l])||a.push(`文件类型不支持，请上传${d[l].join("、")}格式的文件`),n(e)||a.push("文件大小不能超过100MB"),{valid:0===a.length,errors:a}}},6539:function(e,l,a){a.r(l),a.d(l,{default:function(){return T}});var t=a(641),o=a(953),n=a(33),d=a(163),u=a(8548),r=a(7196),p=a(1322),i=a(784);const c={class:"pdf-convert"},b={class:"card-header"},g={key:0,class:"result-section"},m={class:"result-info"},s={key:0},F={key:1};var k={__name:"PdfConvert",setup(e){const l=(0,o.KR)(),a=(0,o.KR)(!1),k=(0,o.KR)(null),f=(0,o.KR)(null),v=(0,o.Kh)({convertType:"word",outputFormat:"docx",preserveFormatting:!0,extractTables:!1,onePagePerSlide:!0,imageFormat:"png",dpi:300,pageRange:"",encoding:"utf-8",splitByPage:!0,embedImages:!0,headingDetection:"auto",includeImages:!0}),_=()=>{"word"===v.convertType?v.outputFormat="docx":"excel"===v.convertType?v.outputFormat="xlsx":"ppt"===v.convertType?v.outputFormat="pptx":"image"===v.convertType?(v.imageFormat="png",v.dpi=300,v.pageRange=""):"txt"===v.convertType?(v.encoding="utf-8",v.pageRange=""):"html"===v.convertType?(v.splitByPage=!0,v.embedImages=!0,v.pageRange=""):"markdown"===v.convertType&&(v.headingDetection="auto",v.includeImages=!0,v.pageRange="")},P=e=>{const a=(0,p.nJ)(e.raw,"PDF");if(!a.valid)return d.nk.error(a.errors[0]),void l.value.clearFiles();k.value=e.raw},V=e=>{const l=(0,p.nJ)(e,"PDF");return l.valid||d.nk.error(l.errors[0]),!1},y=async()=>{if(k.value){a.value=!0;try{const e=new FormData;let l;switch(e.append("file",k.value),v.convertType){case"word":e.append("outputFormat",v.outputFormat),e.append("preserveFormatting",v.preserveFormatting.toString()),l=await r.DC.convertToWord(e);break;case"excel":e.append("outputFormat",v.outputFormat),e.append("extractTables",v.extractTables.toString()),l=await r.DC.convertToExcel(e);break;case"ppt":e.append("outputFormat",v.outputFormat),e.append("onePagePerSlide",v.onePagePerSlide.toString()),l=await r.DC.convertToPpt(e);break;case"image":e.append("imageFormat",v.imageFormat),e.append("dpi",v.dpi.toString()),e.append("pageRange",v.pageRange),l=await r.DC.convertToImages(e);break;case"txt":e.append("encoding",v.encoding),e.append("pageRange",v.pageRange),l=await r.DC.convertToTxt(e);break;case"html":e.append("splitByPage",v.splitByPage.toString()),e.append("embedImages",v.embedImages.toString()),e.append("pageRange",v.pageRange),l=await r.DC.convertToHtml(e);break;case"markdown":e.append("includeImages",v.includeImages.toString()),e.append("headingDetection",v.headingDetection),e.append("pageRange",v.pageRange),l=await r.DC.convertToMarkdown(e);break}f.value=l,d.nk.success("PDF转换成功")}catch(e){console.error("PDF转换失败:",e)}finally{a.value=!1}}else d.nk.warning("请先选择PDF文件")},T=async()=>{if(f.value?.data?.downloadUrl)try{let e;e="image"===v.convertType?"converted_images.zip":f.value.data.convertedFile||"converted_file",(0,i.downloadFile)(f.value.data.downloadUrl,e),d.nk.success("下载已开始")}catch(e){console.error("下载失败:",e),d.nk.error("下载失败，请重试")}else d.nk.warning("没有可下载的文件")},h=()=>{v.convertType="word",v.outputFormat="docx",v.preserveFormatting=!0,v.extractTables=!1,v.onePagePerSlide=!0,v.imageFormat="png",v.dpi=300,v.pageRange="",k.value=null,f.value=null,l.value?.clearFiles()};return(e,d)=>{const r=(0,t.g2)("el-icon"),p=(0,t.g2)("el-upload"),i=(0,t.g2)("el-form-item"),D=(0,t.g2)("el-radio"),x=(0,t.g2)("el-radio-group"),w=(0,t.g2)("el-switch"),R=(0,t.g2)("el-input-number"),C=(0,t.g2)("el-input"),W=(0,t.g2)("el-option"),L=(0,t.g2)("el-select"),U=(0,t.g2)("el-button"),I=(0,t.g2)("el-form"),E=(0,t.g2)("el-divider"),X=(0,t.g2)("el-alert"),S=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(S,{class:"box-card"},{header:(0,t.k6)(()=>[(0,t.Lk)("div",b,[d[18]||(d[18]=(0,t.Lk)("span",null,"PDF格式转换",-1)),(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.Refresh))]),_:1})])]),default:(0,t.k6)(()=>[(0,t.bF)(I,{model:v,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(i,{label:"选择PDF文件",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(p,{ref_key:"uploadRef",ref:l,"auto-upload":!1,limit:1,"on-change":P,"before-upload":V,accept:".pdf",drag:""},{tip:(0,t.k6)(()=>[...d[19]||(d[19]=[(0,t.Lk)("div",{class:"el-upload__tip"}," 只能上传PDF文件，且不超过100MB ",-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(r,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.UploadFilled))]),_:1}),d[20]||(d[20]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将PDF文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1},512)]),_:1}),(0,t.bF)(i,{label:"转换类型",required:""},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.convertType,"onUpdate:modelValue":d[0]||(d[0]=e=>v.convertType=e),onChange:_},{default:(0,t.k6)(()=>[(0,t.bF)(D,{label:"word"},{default:(0,t.k6)(()=>[...d[21]||(d[21]=[(0,t.eW)("转Word",-1)])]),_:1}),(0,t.bF)(D,{label:"excel"},{default:(0,t.k6)(()=>[...d[22]||(d[22]=[(0,t.eW)("转Excel",-1)])]),_:1}),(0,t.bF)(D,{label:"ppt"},{default:(0,t.k6)(()=>[...d[23]||(d[23]=[(0,t.eW)("转PPT",-1)])]),_:1}),(0,t.bF)(D,{label:"image"},{default:(0,t.k6)(()=>[...d[24]||(d[24]=[(0,t.eW)("转图片",-1)])]),_:1}),(0,t.bF)(D,{label:"txt"},{default:(0,t.k6)(()=>[...d[25]||(d[25]=[(0,t.eW)("转TXT",-1)])]),_:1}),(0,t.bF)(D,{label:"html"},{default:(0,t.k6)(()=>[...d[26]||(d[26]=[(0,t.eW)("转HTML",-1)])]),_:1}),(0,t.bF)(D,{label:"markdown"},{default:(0,t.k6)(()=>[...d[27]||(d[27]=[(0,t.eW)("转Markdown",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"word"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(i,{label:"输出格式"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.outputFormat,"onUpdate:modelValue":d[1]||(d[1]=e=>v.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(D,{label:"docx"},{default:(0,t.k6)(()=>[...d[28]||(d[28]=[(0,t.eW)("DOCX",-1)])]),_:1}),(0,t.bF)(D,{label:"doc"},{default:(0,t.k6)(()=>[...d[29]||(d[29]=[(0,t.eW)("DOC",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"保持格式"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.preserveFormatting,"onUpdate:modelValue":d[2]||(d[2]=e=>v.preserveFormatting=e)},null,8,["modelValue"]),d[30]||(d[30]=(0,t.Lk)("div",{class:"form-tip"},"是否保持原PDF的格式",-1))]),_:1})],64)):(0,t.Q3)("",!0),"excel"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.bF)(i,{label:"输出格式"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.outputFormat,"onUpdate:modelValue":d[3]||(d[3]=e=>v.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(D,{label:"xlsx"},{default:(0,t.k6)(()=>[...d[31]||(d[31]=[(0,t.eW)("XLSX",-1)])]),_:1}),(0,t.bF)(D,{label:"xls"},{default:(0,t.k6)(()=>[...d[32]||(d[32]=[(0,t.eW)("XLS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"只提取表格"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.extractTables,"onUpdate:modelValue":d[4]||(d[4]=e=>v.extractTables=e)},null,8,["modelValue"]),d[33]||(d[33]=(0,t.Lk)("div",{class:"form-tip"},"是否只提取PDF中的表格内容",-1))]),_:1})],64)):(0,t.Q3)("",!0),"ppt"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[(0,t.bF)(i,{label:"输出格式"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.outputFormat,"onUpdate:modelValue":d[5]||(d[5]=e=>v.outputFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(D,{label:"pptx"},{default:(0,t.k6)(()=>[...d[34]||(d[34]=[(0,t.eW)("PPTX",-1)])]),_:1}),(0,t.bF)(D,{label:"ppt"},{default:(0,t.k6)(()=>[...d[35]||(d[35]=[(0,t.eW)("PPT",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"每页一幻灯片"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.onePagePerSlide,"onUpdate:modelValue":d[6]||(d[6]=e=>v.onePagePerSlide=e)},null,8,["modelValue"]),d[36]||(d[36]=(0,t.Lk)("div",{class:"form-tip"},"是否将PDF的每一页转换为一个幻灯片",-1))]),_:1})],64)):(0,t.Q3)("",!0),"image"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:3},[(0,t.bF)(i,{label:"图片格式"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:v.imageFormat,"onUpdate:modelValue":d[7]||(d[7]=e=>v.imageFormat=e)},{default:(0,t.k6)(()=>[(0,t.bF)(D,{label:"png"},{default:(0,t.k6)(()=>[...d[37]||(d[37]=[(0,t.eW)("PNG",-1)])]),_:1}),(0,t.bF)(D,{label:"jpg"},{default:(0,t.k6)(()=>[...d[38]||(d[38]=[(0,t.eW)("JPG",-1)])]),_:1}),(0,t.bF)(D,{label:"jpeg"},{default:(0,t.k6)(()=>[...d[39]||(d[39]=[(0,t.eW)("JPEG",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"分辨率(DPI)"},{default:(0,t.k6)(()=>[(0,t.bF)(R,{modelValue:v.dpi,"onUpdate:modelValue":d[8]||(d[8]=e=>v.dpi=e),min:72,max:600,step:72},null,8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"页数范围"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:v.pageRange,"onUpdate:modelValue":d[9]||(d[9]=e=>v.pageRange=e),placeholder:"如: 1-5 (不填则转换全部)",clearable:""},null,8,["modelValue"]),d[40]||(d[40]=(0,t.Lk)("div",{class:"form-tip"},"指定要转换的页数范围，不填则转换全部页面",-1))]),_:1})],64)):(0,t.Q3)("",!0),"txt"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:4},[(0,t.bF)(i,{label:"文本编码"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{modelValue:v.encoding,"onUpdate:modelValue":d[10]||(d[10]=e=>v.encoding=e),placeholder:"选择编码"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{label:"UTF-8",value:"utf-8"}),(0,t.bF)(W,{label:"GBK",value:"gbk"}),(0,t.bF)(W,{label:"GB2312",value:"gb2312"}),(0,t.bF)(W,{label:"ISO-8859-1",value:"iso-8859-1"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"页数范围"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:v.pageRange,"onUpdate:modelValue":d[11]||(d[11]=e=>v.pageRange=e),placeholder:"如: 1-5 (不填则转换全部)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),"html"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:5},[(0,t.bF)(i,{label:"按页分节"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.splitByPage,"onUpdate:modelValue":d[12]||(d[12]=e=>v.splitByPage=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"内嵌图片"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.embedImages,"onUpdate:modelValue":d[13]||(d[13]=e=>v.embedImages=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"页数范围"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:v.pageRange,"onUpdate:modelValue":d[14]||(d[14]=e=>v.pageRange=e),placeholder:"如: 1-5 (不填则转换全部)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),"markdown"===v.convertType?((0,t.uX)(),(0,t.CE)(t.FK,{key:6},[(0,t.bF)(i,{label:"标题识别"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{modelValue:v.headingDetection,"onUpdate:modelValue":d[15]||(d[15]=e=>v.headingDetection=e)},{default:(0,t.k6)(()=>[(0,t.bF)(W,{label:"自动",value:"auto"}),(0,t.bF)(W,{label:"简单",value:"simple"}),(0,t.bF)(W,{label:"关闭",value:"none"})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"包含图片"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:v.includeImages,"onUpdate:modelValue":d[16]||(d[16]=e=>v.includeImages=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(i,{label:"页数范围"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:v.pageRange,"onUpdate:modelValue":d[17]||(d[17]=e=>v.pageRange=e),placeholder:"如: 1-5 (不填则转换全部)",clearable:""},null,8,["modelValue"])]),_:1})],64)):(0,t.Q3)("",!0),(0,t.bF)(i,null,{default:(0,t.k6)(()=>[(0,t.bF)(U,{type:"primary",loading:a.value,disabled:!k.value,onClick:y},{default:(0,t.k6)(()=>[(0,t.eW)((0,n.v_)(a.value?"转换中...":"开始转换"),1)]),_:1},8,["loading","disabled"]),(0,t.bF)(U,{onClick:h},{default:(0,t.k6)(()=>[...d[41]||(d[41]=[(0,t.eW)("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),f.value?((0,t.uX)(),(0,t.CE)("div",g,[(0,t.bF)(E,null,{default:(0,t.k6)(()=>[...d[42]||(d[42]=[(0,t.eW)("转换结果",-1)])]),_:1}),(0,t.bF)(X,{title:f.value.msg,type:"success",closable:!1,"show-icon":""},null,8,["title"]),(0,t.Lk)("div",m,[(0,t.Lk)("p",null,[d[43]||(d[43]=(0,t.Lk)("strong",null,"任务ID:",-1)),(0,t.eW)(" "+(0,n.v_)(f.value.data.taskId),1)]),"image"===v.convertType?((0,t.uX)(),(0,t.CE)("p",s,[d[44]||(d[44]=(0,t.Lk)("strong",null,"转换图片数:",-1)),(0,t.eW)(" "+(0,n.v_)(f.value.data.images?.length||0),1)])):((0,t.uX)(),(0,t.CE)("p",F,[d[45]||(d[45]=(0,t.Lk)("strong",null,"转换文件:",-1)),(0,t.eW)(" "+(0,n.v_)(f.value.data.convertedFile),1)])),(0,t.bF)(U,{type:"success",onClick:T},{default:(0,t.k6)(()=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,o.R1)(u.Download))]),_:1}),d[46]||(d[46]=(0,t.eW)(" 下载结果 ",-1))]),_:1})])])):(0,t.Q3)("",!0)]),_:1})])}}},f=a(6262);const v=(0,f.A)(k,[["__scopeId","data-v-01ef5fc0"]]);var _=v;const P={class:"pdf-convert-page"};var V={__name:"PdfConvert",setup(e){return(e,l)=>((0,t.uX)(),(0,t.CE)("div",P,[(0,t.bF)(_),l[0]||(l[0]=(0,t.Lk)("section",{class:"info-block"},[(0,t.Lk)("h2",null,"功能说明"),(0,t.Lk)("p",null,"在PDF与多种格式之间互转，例如PDF转图片、PDF转Word/Excel/PPT，或将其他格式转为PDF。"),(0,t.Lk)("h3",null,"使用案例"),(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,"将PDF导出为图片，便于在网页或社交媒体展示。"),(0,t.Lk)("li",null,"把PDF转为可编辑的Word进行二次修改。"),(0,t.Lk)("li",null,"将文档统一转为PDF以便长期归档与分享。")])],-1))]))}};const y=(0,f.A)(V,[["__scopeId","data-v-711dcac2"]]);var T=y}}]);
//# sourceMappingURL=539.45e1028e.js.map